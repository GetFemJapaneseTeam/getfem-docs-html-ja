<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>熱および電気弾性連成の例 (単純な非線形結合問題、モデルオブジェクト、汎用アセンブリ、解析および可視化) &mdash; GetFEM++</title>
    
    <link rel="stylesheet" href="../static/getfem.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/translations.js"></script>
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="GetFEM++" href="../index.html" />
    <link rel="up" title="GetFEM++ の導入" href="index.html" />
    <link rel="next" title="接触する車輪の例 (2つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)" href="wheel.html" />
    <link rel="prev" title="GetFEM++ の基本的な使い方" href="basic_usage.html" />
    <link rel="shortcut icon" type="image/png" href="../static/icon.png" />
 

  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="wheel.html" title="接触する車輪の例 (2つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="basic_usage.html" title="GetFEM++ の基本的な使い方"
             accesskey="P">前へ</a> |</li>
        <li><a href="https://savannah.nongnu.org/projects/getfem" <img src="../static/icon.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li></a>
        <li><a href="../index.html">GetFEM++</a> &raquo;</li>

          <li><a href="index.html" accesskey="U"><em>GetFEM++</em> の導入</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="example-of-thermo-elastic-and-electrical-coupling-simple-nonlinear-coupled-problem-model-object-generic-assembly-solve-and-visualization">
<span id="tut-thermo-elec-coupling"></span><h1>熱および電気弾性連成の例 (単純な非線形結合問題、モデルオブジェクト、汎用アセンブリ、解析および可視化)<a class="headerlink" href="#example-of-thermo-elastic-and-electrical-coupling-simple-nonlinear-coupled-problem-model-object-generic-assembly-solve-and-visualization" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>この例では、変位フィールド、温度フィールド、および電位フィールドの非線形結合を持つマルチフィジックス問題の簡単な例を紹介します。また、C++ ライブラリと異なるインターフェイスの使用法を比較することも目的としています。対応するデモファイルは、 <em>GetFEM++</em> のテストディレクトリにあります( <cite>tests/</cite> 、 <cite>interface/tests/python</cite> 、 <cite>interface/scr/scilab/demos</cite> 、  <cite>interface/tests/matlab</cite> )。</p>
<div class="section" id="the-problem-setting">
<h2>問題の設定<a class="headerlink" href="#the-problem-setting" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p><img class="math" src="../images/math/34351db8edc91cfb50b5af8de09529d0749640b6.png" alt="\Omega \subset \R^2" style="vertical-align: -1px"/> は、2D プレートの参照構成です( <a class="reference internal" href="#tut-fig-meshthermo"><em>ここ</em></a> のジオメトリを参照してください)、ここで厚さ <img class="math" src="../images/math/e2a63918a6fa75b62ad87ad17aaf65f782d71546.png" alt="\varepsilon" style="vertical-align: 0px"/> は外部力、電位および加熱に寄与します。ここで、 <img class="math" src="../images/math/e12a8af9b8f2086ce34f3e02c89d08ada2196878.png" alt="\theta : \Omega \rightarrow \R" style="vertical-align: -1px"/> は( °C 内の)温度フィールド、 <img class="math" src="../images/math/0023b81a095415f3c7a3804f54889dd50c74d4cc.png" alt="V : \Omega \rightarrow \R" style="vertical-align: -1px"/> は電位フィールドです。また、 <img class="math" src="../images/math/2a5413a809159a22a4d5aee9cdfc6bb4183d57d2.png" alt="u : \Omega \rightarrow \R^2" style="vertical-align: -1px"/> は膜変位場です。</p>
<div class="section" id="thermal-problem">
<h3>熱問題<a class="headerlink" href="#thermal-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>プレートの表裏面は、熱伝達係数 <img class="math" src="../images/math/9ffb448918db29f2a72f8f87f421b3b3cad18f95.png" alt="D" style="vertical-align: 0px"/> の (20 °C である) 空気と熱交換しており、プレートの側面は断熱であると想定されています。</p>
<p>熱方程式 <img class="math" src="../images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta" style="vertical-align: 0px"/> と境界条件は次のように書くことができます。</p>
<div class="math">
<p><img src="../images/math/21f096380e3c73a1f4556157ed61ae2993aab0e4.png" alt="\left\{\begin{array}{l}
-\mbox{div}(\varepsilon\kappa(\nabla \theta)) + 2D(\theta - T_0) - \varepsilon\sigma|\nabla V|^2 = 0 ~~ \mbox{ in } \Omega, \\
\kappa\nabla \theta \cdot n = 0 ~~ \mbox{ on } \partial \Omega,
\end{array} \right."/></p>
</div><p>熱伝導率は <img class="math" src="../images/math/da61bb0fa48fe71269aebf9c8e56b39275813994.png" alt="\kappa" style="vertical-align: 0px"/> により設計されています、 <img class="math" src="../images/math/6801c07694edb238c4a095956d8bf46ccdb38fcc.png" alt="T_0" style="vertical-align: -3px"/> は空気の温度、 <img class="math" src="../images/math/8e8ad6e6563df57ba65066164700f8005af358ef.png" alt="\partial \Omega" style="vertical-align: -1px"/> は、領域 <img class="math" src="../images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega" style="vertical-align: 0px"/> の境界であり <img class="math" src="../images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n" style="vertical-align: 0px"/> は <img class="math" src="../images/math/8e8ad6e6563df57ba65066164700f8005af358ef.png" alt="\partial \Omega" style="vertical-align: -1px"/> 上の <img class="math" src="../images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega" style="vertical-align: 0px"/> への外向きの単位法線ベクトルです。</p>
<p>項 <img class="math" src="../images/math/6d2aa0f2f47ea4c258351586351607471876996f.png" alt="\sigma|\nabla V|^2" style="vertical-align: -5px"/> は、Joule加熱項に対応する非線形結合項であり、ここで <img class="math" src="../images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma" style="vertical-align: 0px"/> は電気伝導率です。</p>
</div>
<div class="section" id="electric-potential-problem">
<h3>電位問題<a class="headerlink" href="#electric-potential-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>私たちは、プレートの左右の側面の間の <img class="math" src="../images/math/21d4a8d43e8c83d941598c902f1d51a81558711d.png" alt="0.1V" style="vertical-align: -1px"/> の電位差を考慮します。他の面は電気的に絶縁されていると考えます。電位の方程式は次の通りです。</p>
<div class="math">
<p><img src="../images/math/228d208aa67c1abbda089d030b386cfa28058a09.png" alt="\left\{\begin{array}{l}
-\mbox{div}(\varepsilon\sigma(\nabla V)) = 0 ~~ \mbox{ in } \Omega, \\
\sigma\nabla V \cdot n = 0 ~~ \mbox{ on the top an bottom lateral faces}, \\
V = 0 ~~ \mbox{ on the right lateral face}, \\
V = 0.1 ~~ \mbox{ on the left lateral face}, \\
\end{array} \right."/></p>
</div><p>ここで <img class="math" src="../images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma" style="vertical-align: 0px"/> はまだ電気伝導性です。さらに、 <img class="math" src="../images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma" style="vertical-align: 0px"/> は、次のように温度に依存すると考えます。</p>
<div class="math">
<p><img src="../images/math/1fcd45830529fae6543dd7e3604b74c2e8355a99.png" alt="\sigma = \Frac{1}{\rho_0(1+\alpha(\theta - T_0))},"/></p>
</div><p>ここで <img class="math" src="../images/math/6801c07694edb238c4a095956d8bf46ccdb38fcc.png" alt="T_0" style="vertical-align: -3px"/> は参照温度 (ここでは空気温度) であり、 <img class="math" src="../images/math/10b071702fff383bdcbc7bbaee13f6beeae9fd7f.png" alt="\rho_0" style="vertical-align: -4px"/> は <img class="math" src="../images/math/6801c07694edb238c4a095956d8bf46ccdb38fcc.png" alt="T_0" style="vertical-align: -3px"/> 上の抵抗温度係数であり、<img class="math" src="../images/math/10f32377ac67d94f764f12a15ea987e88c85d3e1.png" alt="\alpha" style="vertical-align: 0px"/> は第2抵抗温度係数です。</p>
</div>
<div class="section" id="deformation-problem">
<h3>変形問題<a class="headerlink" href="#deformation-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>右側面に加わる力の下でのプレートの微小変形を考慮し, プレートの加熱によって影響を受けるとします。変位 <img class="math" src="../images/math/9ad99798ec4c38e165cf517cb9e02b1c9e824103.png" alt="u" style="vertical-align: 0px"/> は、次の(線形化された弾性)問題の解になります。</p>
<div class="math">
<p><img src="../images/math/6e21f54c88108e97c48123fa3e4a5694ac874395.png" alt="\left\{\begin{array}{l}
-\mbox{div}(\bar{\sigma}(u)) = 0 ~~ \mbox{ in } \Omega, \\
\bar{\sigma}\ n = 0 ~~ \mbox{ on the top an bottom lateral faces}, \\
\bar{\sigma}\ n = F ~~ \mbox{ on the right lateral face}, \\
u = 0 ~~ \mbox{ on the left lateral face},
\end{array} \right."/></p>
</div><p>ここで <img class="math" src="../images/math/a055f405829e64a3b70253ab67cb45ed6ed5bb29.png" alt="F" style="vertical-align: 0px"/> は、右側横方向の境界に適用される力密度であり、 <img class="math" src="../images/math/12afdcbe343f8c19498315ecedfddf832ee97b4f.png" alt="\bar{\sigma}(u)" style="vertical-align: -4px"/> は、次のように定義されたCauchy応力テンソルです。</p>
<div class="math">
<p><img src="../images/math/a7351de7f14eb96bd24887fefeafc27fcea4c1e5.png" alt="\bar{\sigma}(u) = \lambda^* \mbox{div}(u) I + 2\mu \bar{\varepsilon}(u) + \beta(T_0-\theta) I,"/></p>
</div><p><img class="math" src="../images/math/7a31a024cda0a4fb9e32b880b9ef853f4b5251ff.png" alt="\bar{\varepsilon}(u) = (\nabla u + (\nabla u)^T)/2" style="vertical-align: -5px"/> は、線形化されたひずみテンソルであり、 <img class="math" src="../images/math/027f4a11d6090f9eac0ce2488df6384dad1263ea.png" alt="I" style="vertical-align: 0px"/> は2次単位テンソルで、 <img class="math" src="../images/math/928ed15c5cfb1301f19a695f24dcdd8d9e7bc84a.png" alt="\lambda^*, \mu" style="vertical-align: -4px"/> は、 Lamé 係数であり次のように定義されます。</p>
<div class="math">
<p><img src="../images/math/06d7859343b74ef363af001d62ccd17f7d7434e1.png" alt="&amp;\lambda = \Frac{E\nu}{(1+\nu)(1-2\nu)}, \\
&amp;\mu = \Frac{E}{2(1+\nu)}, \\
&amp;\lambda^* = \Frac{2\lambda\mu}{\lambda+2*\mu},"/></p>
</div><p><img class="math" src="../images/math/fa2fa899f0afb05d6837885523503a2d4df434f9.png" alt="E" style="vertical-align: 0px"/> は材料のヤング係数であり <img class="math" src="../images/math/d6a7ccf879c4a4fe694033606332cb83806db296.png" alt="\nu" style="vertical-align: 0px"/> はポアソン比です。</p>
<p>項 <img class="math" src="../images/math/a91e01c92de562ecfc5d082c2d1334ea441aa25f.png" alt="\beta(T_0-\theta) I" style="vertical-align: -4px"/> は、熱膨張の項に対応しています。ここで <img class="math" src="../images/math/8ee78acaa7dcac5fbf8b981be39a4d79c05c3489.png" alt="\beta = \alpha_{th} E/(1-2\nu)" style="vertical-align: -5px"/> 、<img class="math" src="../images/math/2130776379db7207c8e6d93192affc75db35d635.png" alt="\alpha_{th}" style="vertical-align: -3px"/> は熱膨張係数です。</p>
</div>
</div>
<div class="section" id="the-weak-formulation">
<h2>弱定式化<a class="headerlink" href="#the-weak-formulation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>重要なステップは、方程式の結合系の弱定式化を得ることです。有限要素定式化は弱定式化 (Galerkin近似)に基づいており、弱定式化は追加される項の表現を与えることができる唯一のものであるため、これは重要なステップです。</p>
<p>各偏微分方程式の弱定式化は、主な未知数はDirichlet条件を満たしている主な未知数のDirichlet条件に対応する試行関数を用いて式を乗算することにより得られ、その後領域 <img class="math" src="../images/math/9e2b196e9b7e57d1ec99f6534c581ea9759d2170.png" alt="\Omega" style="vertical-align: 0px"/> 上の積分と(Greenの式を使用した)部分の積分を実行します。偏微分方程式系の弱定式化は次の通りです。</p>
<div class="math">
<p><img src="../images/math/07635cc1ae68c52b7548f1a5508d9768c3c5b199.png" alt="&amp;\mbox{Find } \theta, V, u \mbox{ with } V = 0.1, u = 0 \mbox{ on the left face}, V = 0 \mbox{ on the right face}, \\
&amp;\ds \int_{\Omega} \varepsilon\kappa\nabla\theta\cdot\nabla\delta_{\theta} + 2D\theta\delta_{\theta}dx = \int_{\Omega} (2DT_0 + \varepsilon\sigma|\nabla V|^2)\delta_{\theta} dx ~~~\mbox{ for all } \delta_{\theta}, \\
&amp;\ds \int_{\Omega} \varepsilon\sigma\nabla V\cdot\nabla\delta_V = 0 dx ~~~ \mbox{ for all } \delta_V \mbox{ satisfying } \delta_V = 0 \mbox{ on the left and right faces}, \\
&amp;\ds \int_{\Omega} \bar{\sigma}(u):\bar{\varepsilon}(\delta_u)dx = \int_{\Gamma_N} F\cdot \delta_u d\Gamma ~~~ \mbox{ for all } \delta_{u} \mbox{ satisfying } \delta_u = 0 \mbox{ on the left face},"/></p>
</div><p>ここで <img class="math" src="../images/math/6a322aecf0783913607e61d7554bb96705d13baf.png" alt="\delta_{\theta}, \delta_V, \delta_u" style="vertical-align: -4px"/> は、それぞれ、 <img class="math" src="../images/math/d16772d1c29fb5174dbc12259590b15ded8fabde.png" alt="\theta, V, u" style="vertical-align: -4px"/> に対応する試行関数です、 <img class="math" src="../images/math/0b983602095bda2a85dd1b0c177f154eaffbecbd.png" alt="\Gamma_N" style="vertical-align: -3px"/> は、力 <img class="math" src="../images/math/a055f405829e64a3b70253ab67cb45ed6ed5bb29.png" alt="F" style="vertical-align: 0px"/> の密度が適用される右の境界を示します、そして <img class="math" src="../images/math/5abb503bf21fd3ce5ed2e4f936193c6304d5a024.png" alt="\bar{\sigma}:\bar{\varepsilon}" style="vertical-align: 0px"/> は、2次テンソル間のFrobeniusスカラー積です。</p>
</div>
<div class="section" id="implementation-in-c-and-with-the-interface">
<h2>C++ での実装とインターフェイス<a class="headerlink" href="#implementation-in-c-and-with-the-interface" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>次に、問題を近似する <em>GetFEM++</em> の使用法についての詳細なプレゼンテーションを行います。C++、Python、Scilab と Matlab プログラムを同時に構築します。Matlab および Scilab プログラムでは、オブジェクト指向コマンドを使用しません (使用する方法は <a class="reference internal" href="../matlab/oocmd.html#mlab-oocmd"><em>GetFEM++ OO-commands</em></a> を参照してください)</p>
<div class="section" id="initialization">
<h3>初期化<a class="headerlink" href="#initialization" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>まず、C++ では、モデルオブジェクト、ジェネリックアセンブリ、線形代数インターフェイス (Gmm++) 、実験用メッシュ、およびエクスポート機能に対して、特定の数のヘッダーを含めることができます。Python の場合、これは簡単です。 <em>GetFEM++</em> をグローバルにインポートすることができます (numpy もインポートする必要があります)。Scilab の場合、ライブラリは Scilab コンソールに最初にロードされます (ここでは説明しません)、Matlab の場合、すべての <em>GetFEM++</em> 変数をクリアする <cite>gf_workspace(&#8216;clear all&#8217;)</cite> を除けば、何も必要ありません。</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="cp">#include &quot;getfem/getfem_model_solvers.h&quot;</span>
<span class="cp">#include &quot;getfem/getfem_export.h&quot;</span>
<span class="cp">#include &quot;gmm/gmm.h&quot;</span>
<span class="cp">#include &quot;getfem/getfem_mesher.h&quot;</span>
<span class="cp">#include &quot;getfem/getfem_generic_assembly.h&quot;</span>

<span class="k">using</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">size_type</span><span class="p">;</span>
<span class="k">using</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">base_node</span><span class="p">;</span>
<span class="k">using</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">base_small_vector</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">getfem</span><span class="o">::</span><span class="n">model_real_plain_vector</span> <span class="n">plain_vector</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">getfem</span> <span class="kn">as</span> <span class="nn">gf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_workspace</span><span class="p">(</span><span class="s">&#39;clear all&#39;</span><span class="p">);</span> <span class="o">//</span> <span class="n">In</span> <span class="k">case</span> <span class="n">of</span> <span class="n">multiple</span> <span class="n">runs</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_workspace</span><span class="p">(</span><span class="s">&#39;clear all&#39;</span><span class="p">);</span> <span class="c">% In case of multiple runs</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parameters-of-the-model">
<h3>モデルのパラメータ<a class="headerlink" href="#parameters-of-the-model" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここで、問題のさまざまな物理的および数値パラメータを定義しましょう。スクリプト言語 (Python、Scilab、Matlab) には違いはありません。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="kt">double</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="c1">// Thickness of the plate (cm)</span>
<span class="kt">double</span> <span class="n">E</span> <span class="o">=</span> <span class="mf">21E6</span><span class="p">;</span>     <span class="c1">// Young Modulus (N/cm^2)</span>
<span class="kt">double</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>     <span class="c1">// Poisson ratio</span>
<span class="kt">double</span> <span class="n">clambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="kt">double</span> <span class="n">cmu</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">));</span>
<span class="kt">double</span> <span class="n">clambdastar</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">clambda</span><span class="o">*</span><span class="n">cmu</span><span class="o">/</span><span class="p">(</span><span class="n">clambda</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">cmu</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">F</span> <span class="o">=</span> <span class="mf">100E2</span><span class="p">;</span>    <span class="c1">// Force density at the right boundary (N/cm^2)</span>
<span class="kt">double</span> <span class="n">kappa</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">;</span>   <span class="c1">// Thermal conductivity (W/(cm K))</span>
<span class="kt">double</span> <span class="n">D</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">;</span>      <span class="c1">// Heat transfer coefficient (W/(K cm^2))</span>
<span class="kt">double</span> <span class="n">air_temp</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span><span class="c1">// Temperature of the air in oC.</span>
<span class="kt">double</span> <span class="n">alpha_th</span> <span class="o">=</span> <span class="mf">16.6E-6</span><span class="p">;</span> <span class="c1">// Thermal expansion coefficient (/K)</span>
<span class="kt">double</span> <span class="n">T0</span> <span class="o">=</span> <span class="mf">20.</span><span class="p">;</span>     <span class="c1">// Reference temperature in oC</span>
<span class="kt">double</span> <span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1.754E-8</span><span class="p">;</span> <span class="c1">// Resistance temperature coefficient at T0</span>
<span class="kt">double</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0039</span><span class="p">;</span> <span class="c1">// Second resistance temperature coefficient</span>

<span class="kt">double</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">2.</span>        <span class="c1">// Approximate mesh size</span>
<span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span> <span class="n">elements_degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Degree of the finite element methods</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Scripts</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">E</span> <span class="o">=</span> <span class="mf">21E6</span><span class="p">;</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="n">clambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="n">cmu</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">));</span>
<span class="n">clambdastar</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">clambda</span><span class="o">*</span><span class="n">cmu</span><span class="o">/</span><span class="p">(</span><span class="n">clambda</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">cmu</span><span class="p">);</span>
<span class="n">F</span> <span class="o">=</span> <span class="mf">100E2</span><span class="p">;</span> <span class="n">kappa</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">air_temp</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">alpha_th</span> <span class="o">=</span> <span class="mf">16.6E-6</span><span class="p">;</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1.754E-8</span><span class="p">;</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0039</span><span class="p">;</span>

<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">elements_degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mesh-generation">
<h3>メッシュ生成<a class="headerlink" href="#mesh-generation" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><em>GetFEM++</em> には、ここで説明するいくつかの限定されたメッシュ機能があります。ここではそれらを使用するつもりです。しかし、得られたメッシュの品質と適合性の保証はありませんので、 <em>GetFEM++</em> メッシュ作成機能を使用する場合はメッシュを確認することをお勧めします。また、外部メッシャ (例えばGiD または Gmsh) を使用してインポートすることもできます( <a class="reference internal" href="../userdoc/bmesh.html#ud-load-save-mesh"><em>メッシュの保存とロード</em></a> をご覧ください)。</p>
<p>領域のジオメトリは、3つの円形の穴がある長方形であることが想定されています ( <a class="reference internal" href="#tut-fig-meshthermo"><em>得られたメッシュ。</em></a> を参照)。ジオメトリは、いくつかの原始的な幾何とunion/setminus 操作によって説明されています ( <tt class="file docutils literal"><span class="pre">src/getfem/getfem_mesher.h</span></tt> ファイルを参照してください)。以下では、 <cite>h</cite> はメッシュサイズを表し、 <cite>2</cite> はメッシュの次数を表します (これは変換が次数2であることを意味し、曲線エッジを使用しています)。</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh</span> <span class="n">mesh</span><span class="p">;</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">pmesher_signed_distance</span>
<span class="n">mo1</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_rectangle</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">base_node</span><span class="p">(</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">)),</span>
<span class="n">mo2</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_ball</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span> <span class="mf">8.</span><span class="p">),</span>
<span class="n">mo3</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_ball</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span> <span class="mf">8.</span><span class="p">),</span>
<span class="n">mo4</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_ball</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">75.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span> <span class="mf">8.</span><span class="p">),</span>
<span class="n">mo5</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_union</span><span class="p">(</span><span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">),</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_setminus</span><span class="p">(</span><span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">getfem</span><span class="o">::</span><span class="n">base_node</span><span class="o">&gt;</span> <span class="n">fixed</span><span class="p">;</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">build_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">mo1</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">])</span>
<span class="n">mo2</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">mo3</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">mo4</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">75.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">mo5</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;union&#39;</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">)</span>
<span class="n">mo</span>  <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;set minus&#39;</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">)</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mo1</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">25</span><span class="p">]);</span>
<span class="n">mo2</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo3</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo4</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo5</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;union&#39;</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">);</span>
<span class="n">mo</span>  <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;set minus&#39;</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">);</span>

<span class="n">mesh</span> <span class="p">=</span> <span class="n">gf_mesh</span><span class="p">(</span><span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mo1</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">25</span><span class="p">]);</span>
<span class="n">mo2</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo3</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo4</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo5</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;union&#39;</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">);</span>
<span class="n">mo</span>  <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;set minus&#39;</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">);</span>

<span class="n">mesh</span> <span class="p">=</span> <span class="n">gf_mesh</span><span class="p">(</span><span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="tut-fig-meshthermo">
<a class="reference internal image-reference" href="../images/mesh_thermo.png"><img alt="../images/mesh_thermo.png" src="../images/mesh_thermo.png" style="width: 975.0px; height: 344.0px;" /></a>
<p class="caption">得られたメッシュ。</p>
</div>
</div>
<div class="section" id="boundary-selection">
<h3>境界の選択<a class="headerlink" href="#boundary-selection" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>境界の異なる部分には異なる境界条件があるため、境界のさまざまな部分に番号を付けなければなりません (穴には、熱と電気の絶縁とともに、応力自由境界条件が想定されます)。したがって、メッシュ上の要素面を選択し、メッシュ領域を定義する必要があります ( <a class="reference internal" href="../userdoc/bmesh.html#ud-mesh-regions"><em>メッシュ領域</em></a> を参照)、1、2、3、4はそれぞれ右境界、左境界、上境界、下境界です。これらの境界番号は、モデルブリックで使用されます。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">border_faces</span><span class="p">;</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">outer_faces_of_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb1</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_in_box</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span> <span class="n">base_node</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span>
                 <span class="n">base_node</span><span class="p">(</span><span class="mf">99.</span><span class="p">,</span> <span class="mf">24.</span><span class="p">));</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb2</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb3</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb4</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb5</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>

<span class="n">size_type</span> <span class="n">RIGHT_BOUND</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TOP_BOUND</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span> <span class="n">RIGHT_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb2</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span>  <span class="n">LEFT_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb3</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span>   <span class="n">TOP_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb4</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span><span class="n">BOTTOM_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb5</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">fb1</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_in_box</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">99.</span><span class="p">,</span> <span class="mf">24.</span><span class="p">])</span>
<span class="n">fb2</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fb3</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fb4</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fb5</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">RIGHT_BOUND</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">LEFT_BOUND</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">TOP_BOUND</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">BOTTOM_BOUND</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">HOLE_BOUND</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>

<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span> <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">fb2</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span>  <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">fb3</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span>   <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">fb4</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">fb5</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span>  <span class="n">HOLE_BOUND</span><span class="p">,</span> <span class="n">fb1</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span> <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span>  <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span>   <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span><span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">fb1</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces in box&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">99</span> <span class="mi">24</span><span class="p">]);</span>
<span class="n">fb2</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb3</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb4</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span>  <span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb5</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>

<span class="n">RIGHT_BOUND</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">LEFT_BOUND</span><span class="p">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">TOP_BOUND</span><span class="p">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">BOTTOM_BOUND</span><span class="p">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">HOLE_BOUND</span><span class="p">=</span><span class="mi">5</span><span class="p">;</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">fb2</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">fb3</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">fb4</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">fb5</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">HOLE_BOUND</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">fb1</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces in box&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">99</span> <span class="mi">24</span><span class="p">]);</span>
<span class="n">fb2</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb3</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb4</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span>  <span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb5</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>

<span class="n">RIGHT_BOUND</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">LEFT_BOUND</span><span class="p">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">TOP_BOUND</span><span class="p">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">BOTTOM_BOUND</span><span class="p">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">HOLE_BOUND</span><span class="p">=</span><span class="mi">5</span><span class="p">;</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">fb2</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">fb3</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">fb4</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">fb5</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">HOLE_BOUND</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mesh-draw">
<h3>メッシュ描画<a class="headerlink" href="#mesh-draw" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>メッシュをプレビューし、その妥当性を制御するために、次の手順を使用します。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp</span><span class="p">(</span><span class="s">&quot;mesh.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mesh</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">write_mesh</span><span class="p">();</span>
<span class="c1">// You can view the mesh for instance with</span>
<span class="c1">// mayavi2 -d mesh.vtk -f ExtractEdges -m Surface</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;mesh.vtk&#39;</span><span class="p">);</span>
<span class="c"># You can view the mesh for instance with</span>
<span class="c"># mayavi2 -d mesh.vtk -f ExtractEdges -m Surface</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">scf</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gf_plot_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&#39;curved&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;regions&#39;</span><span class="p">,</span> <span class="c">...</span>
             <span class="p">[</span><span class="n">RIGHT_BOUND</span> <span class="n">LEFT_BOUND</span> <span class="n">TOP_BOUND</span> <span class="n">BOTTOM_BOUND</span><span class="p">]);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Mesh&#39;</span><span class="p">);</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_plot_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&#39;curved&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;regions&#39;</span><span class="p">,</span> <span class="c">...</span>
             <span class="p">[</span><span class="n">RIGHT_BOUND</span> <span class="n">LEFT_BOUND</span> <span class="n">TOP_BOUND</span> <span class="n">BOTTOM_BOUND</span><span class="p">]);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Mesh&#39;</span><span class="p">);</span>
<span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>C++ および Python インターフェイスでは、外部グラフィカルポストプロセッサを使用する必要があります (たとえば、gmsh、Mayavi2、または Paraview)。Scilab および Matlab インタフェースでは、内部プロット機能を使用することができます (結果は <a class="reference internal" href="#tut-fig-meshthermo"><em>得られたメッシュ。</em></a> を参照)。</p>
</div>
<div class="section" id="definition-of-finite-element-methods-and-integration-method">
<h3>有限要素法の定義と積分法<a class="headerlink" href="#definition-of-finite-element-methods-and-integration-method" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>3つの有限要素法を定義します。最初の1つは、変位フィールドを近似する <cite>mfu</cite> です。これはベクトルフィールドです。これは C++ では次のように定義されます。</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mfu</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">mfu</span><span class="p">.</span><span class="n">set_classical_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>
</pre></div>
</div>
<p>ここで、 <cite>2</cite> はベクトル場の次元を表します。2行目は、使用する有限要素を設定します。 <cite>classical_finite_element</cite> は、連続したLagrange要素を意味し、<cite>elements_degree</cite> は <cite>2</cite> に設定されていることを覚えておいてください、これは2次の (アイソパラメトリック) 要素を使用することを意味します。</p>
<p><em>GetFEM++</em> には、既存の有限要素法の幅広い選択肢があります、 <a class="reference internal" href="../userdoc/appendixA.html#ud-appendixa"><em>付録A.有限要素法リスト</em></a> を参照してください。しかし、 Lagrange 有限要素法は、実際に最も使用されています。</p>
<p>第2の有限要素法はスカラーで、温度場と電位場の両方を近似する <cite>mft</cite> です。単一の有限要素法は、任意の数の有限要素変数を近似するのに役立ちます。</p>
<p>3番目の有限要素法は不連続なスカラーLagrangeで、1つの変数の導関数を補間することができます (たとえば、Von Mises応力の補間)。</p>
<p>最後に定義するものは、積分法 <cite>mim</cite> です。<em>GetFEM++</em> にデフォルトの積分法はありません。したがって、これは積分法を定義するために必須です。もちろん、積分法の次数は、選択された有限要素法に好都合な積分を行うために十分に選定しなければなりません。ここでは、 <cite>elements_degree</cite> の2乗で十分です。</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mfu</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">mfu</span><span class="p">.</span><span class="n">set_classical_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mft</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">mft</span><span class="p">.</span><span class="n">set_classical_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mfvm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">mfvm</span><span class="p">.</span><span class="n">set_classical_discontinuous_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_im</span>  <span class="n">mim</span><span class="p">(</span><span class="n">mesh</span><span class="p">);</span>
<span class="n">mim</span><span class="p">.</span><span class="n">set_integration_method</span><span class="p">(</span><span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">gmm</span><span class="o">::</span><span class="n">sqr</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)));</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">mfu</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshFem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mfu</span><span class="o">.</span><span class="n">set_classical_fem</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)</span>
<span class="n">mft</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshFem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mft</span><span class="o">.</span><span class="n">set_classical_fem</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)</span>
<span class="n">mfvm</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshFem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mfvm</span><span class="o">.</span><span class="n">set_classical_discontinuous_fem</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)</span>
<span class="n">mim</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshIm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mfu</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mft</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mfvm</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;classical discontinuous fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">mim</span> <span class="p">=</span> <span class="n">gf_mesh_im</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">elements_degree</span>^<span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mfu</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mft</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mfvm</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;classical discontinuous fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">mim</span> <span class="p">=</span> <span class="n">gf_mesh_im</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">elements_degree</span>^<span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="model-definition">
<h3>モデル定義<a class="headerlink" href="#model-definition" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><em>GetFEM++</em> のモデルオブジェクトの変数(未知数)、データ、およびモデルブリックと呼ばれるものを収集します。モデルブリックは、単一の変数に適用されるモデル (線形または非線形項) の一部であるか、複数の変数をリンクしています。これらは、(接線) 線形システムの組み立てのために使用されます (詳細については <a class="reference internal" href="../userdoc/model_object.html#ud-model-object"><em>modelオブジェクト</em></a> を参照してください)。</p>
<p>これは、構築手順を直接使用し、(接線) 線形システムを所有することによって構築されるため、モデルオブジェクトを使用することは厳密には必須ではありません。モデルオブジェクトは、モデルのほとんどの古典的な部分が事前にプログラムされているので、モデルの素早い構築を可能にします。 標準境界条件、標準偏微分方程式、制約を処理するための乗数の使用...さらに、いくつかのブリックは、標準ブリック (ジェネリックアセンブリブリック、明示的なマトリックスブリック) の拡張が可能なように設計されています。そのため、モデルオブジェクトのフレームワークを使用することをお勧めします。</p>
<p>モデルには2つのバージョンがあります: 実数と複素数。複素数モデルは複雑な線形システムを解くのに有利な特殊なアプリケーション (例えば、いくつかの電磁気学の問題) のために予約されています。</p>
<p>計算される3つのフィールドに対応する3つの変数を持つ実際のモデルを宣言してみましょう :</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">model</span> <span class="n">md</span><span class="p">;</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">=</span><span class="n">gf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s">&#39;real&#39;</span><span class="p">);</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">md</span><span class="p">=</span><span class="n">gf_model</span><span class="p">(</span><span class="s">&#39;real&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">md</span><span class="p">=</span><span class="n">gf_model</span><span class="p">(</span><span class="s">&#39;real&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="membrane-elastic-deformation-problem">
<h3>弾性膜変形問題<a class="headerlink" href="#membrane-elastic-deformation-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここでは、弾性変形問題から始めましょう。以下の <cite>add_isotropic_linearized_elasticity_brick</cite> によって追加されている定義済みのブリックを使用します。基本的には、それに対応する項</p>
<div class="math">
<p><img src="../images/math/b8a15b79aa8793124675da9b1c74bdb0a4191310.png" alt="\int_{\Omega} (\lambda^* \mbox{div}(u) I + 2\mu \bar{\varepsilon}(u)):\bar{\varepsilon}(\delta_u)dx,"/></p>
</div><p>の追加を接線線形システムに対して行います。このモデルブリックを使用するために、対応するデータ Lamé 係数は、最初にモデルに追加する必要があります。ここでは、 Lamé 係数は、領域に対して一定です。ただし、一部の非定数データを定義することもできます。また、この定義済みのブリックを使用する代わりに、弱形式言語項 <cite>add_linear_term(md mim, &#8220;lambda*(Div_u*Div_Test_u) + mu*((Grad_u + Grad_u&#8217;):Grad_Test_u)&#8221;</cite> を等価に使用することができることに注意してください。</p>
<p>結合項</p>
<div class="math">
<p><img src="../images/math/2562e1e538a37c6d30d57352772d9a0d13364e59.png" alt="\int_{\Omega} (\beta\theta I) :\bar{\varepsilon}(\delta_u)dx,"/></p>
</div><p>は定義済みのブリックはなく、弱形式言語項 <cite>add_linear_term(md mim, &#8220;beta*theta*Div_Test_u)&#8221;</cite> を直接使用します。弱形式言語の詳細については、 <a class="reference internal" href="../userdoc/gasm_high.html#ud-gasm-high"><em>任意の項を計算する - 高水準の汎用的な構築手順 - 弱形式言語</em></a> を参照してください。基本的に、アセンブリ文字列は、各Gauss点で実行される最適化されたアセンブリ命令のリストに編集することが原則です。</p>
<p>以下のプログラムは、全体の弾性変形方程式を考慮に入れることができます。左側の境界に Dirichlet 条件を規定するために、特定のブリックを使用することに注意してください。Dirichlet条件を規定するいくつかのオプションがあります( <a class="reference internal" href="../userdoc/model_dirichlet.html#ud-model-dirichlet"><em>Dirichlet条件ブリック要素</em></a> を参照)。</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;cmu&quot;</span><span class="p">,</span> <span class="n">cmu</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;clambdastar&quot;</span><span class="p">,</span> <span class="n">clambdastar</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;T0&quot;</span><span class="p">,</span> <span class="n">T0</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_isotropic_linearized_elasticity_brick</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;clambdastar&quot;</span><span class="p">,</span> <span class="s">&quot;cmu&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_Dirichlet_condition_with_multipliers</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">LEFT_BOUND</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_fixed_size_data</span><span class="p">(</span><span class="s">&quot;Fdata&quot;</span><span class="p">,</span> <span class="n">base_small_vector</span><span class="p">(</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span><span class="mf">0.</span><span class="p">));</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;Fdata&quot;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>

<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;beta&quot;</span><span class="p">,</span> <span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_linear_term</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;beta*(T0-theta)*Div_Test_u&quot;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cmu</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">clambdastar</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;T0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">T0</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_isotropic_linearized_elasticity_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">)</span>

<span class="n">md</span><span class="o">.</span><span class="n">add_Dirichlet_condition_with_multipliers</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">)</span>

<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_linear_term</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;beta*(T0-theta)*Div_Test_u&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cmu</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">clambdastar</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;T0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">T0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add isotropic linearized elasticity brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add linear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;beta*(T0-theta)*Div_Test_u&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cmu</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">clambdastar</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;T0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">T0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add isotropic linearized elasticity brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add linear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;beta*(T0-theta)*Div_Test_u&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id1">
<h3>電位問題<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>同様に、以下のプログラムは、電位方程式を考慮しています。電気伝導率 <img class="math" src="../images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma" style="vertical-align: 0px"/> と再度の弱形式言語用語の使用の定義に注意してください。</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sigmaeps</span> <span class="o">=</span> <span class="s">&quot;(eps/(rho_0*(1+alpha*(theta-T0))))&quot;</span><span class="p">;</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;eps&quot;</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;rho_0&quot;</span><span class="p">,</span> <span class="n">rho_0</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_nonlinear_term</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">sigmaeps</span><span class="o">+</span><span class="s">&quot;*(Grad_V.Grad_Test_V)&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_Dirichlet_condition_with_multipliers</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;DdataV&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_Dirichlet_condition_with_multipliers</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&quot;DdataV&quot;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">sigmaeps</span> <span class="o">=</span> <span class="s">&#39;(eps/(rho_0*(1+alpha*(theta-T0))))&#39;</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;rho_0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_0</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_nonlinear_term</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*(Grad_V.Grad_Test_V)&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_Dirichlet_condition_with_multipliers</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;DdataV&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_Dirichlet_condition_with_multipliers</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">sigmaps</span> <span class="p">=</span> <span class="s">&#39;(eps/(rho_0*(1+alpha*(theta-T0))))&#39;</span><span class="p">;</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;rho_0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*(Grad_V.Grad_Test_V)&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">sigmaps</span> <span class="p">=</span> <span class="s">&#39;(eps/(rho_0*(1+alpha*(theta-T0))))&#39;</span><span class="p">;</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;rho_0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="p">[</span><span class="n">sigmaeps</span> <span class="s">&#39;*(Grad_V.Grad_Test_V)&#39;</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id2">
<h3>熱問題<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここで、熱問題を考慮するプログラムは次の通りです。</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;kaeps&quot;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_generic_elliptic_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="s">&quot;kaeps&quot;</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;D2&quot;</span><span class="p">,</span> <span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;D2airt&quot;</span><span class="p">,</span> <span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_mass_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="s">&quot;D2&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="s">&quot;D2airt&quot;</span><span class="p">);</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">add_nonlinear_term</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&quot;*Norm_sqr(Grad_V)*Test_theta&quot;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;kaeps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_generic_elliptic_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;D2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;D2airt&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_mass_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">)</span>

<span class="n">md</span><span class="o">.</span><span class="n">add_nonlinear_term</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Norm_sqr(Grad_V)*Test_theta&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add generic elliptic brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add mass brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Norm_sqr(Grad_V)*Test_theta&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add generic elliptic brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add mass brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;-&#39;</span> <span class="n">sigmaeps</span> <span class="s">&#39;*Norm_sqr(Grad_V)*Test_theta&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="model-solve">
<h3>モデル求解<a class="headerlink" href="#model-solve" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>モデルが正しく定義されたら、次のようにして簡単に解くことができます。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">gmm</span><span class="o">::</span><span class="n">iteration</span> <span class="n">iter</span><span class="p">(</span><span class="mf">1E-9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">standard_solve</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>問題は全体的に非線形であるため、Newton法を用いて問題を反復的に解きます。数回のイテレーションが必要です (この場合は約4です)。</p>
</div>
<div class="section" id="model-solve-with-two-steps">
<h3>モデルは2つのステップで解きます<a class="headerlink" href="#model-solve-with-two-steps" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>問題を解決するもう一つの選択肢は、最初に熱と電位の問題を解くことです。実際、我々のモデルでは、熱および電位は変形に依存しません。熱と電位の問題を解いたら、変形の問題を解きます。これは、次のように行うことができます。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">gmm</span><span class="o">::</span><span class="n">iteration</span> <span class="n">iter</span><span class="p">(</span><span class="mf">1E-9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">standard_solve</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">enable_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">);</span>
<span class="n">iter</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">standard_solve</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">enable_variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;enable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;enable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="export-visualization-of-the-solution">
<h3>解のエクスポート/可視化<a class="headerlink" href="#export-visualization-of-the-solution" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>有限要素問題が解かれました。次のように解をプロットすることができます。C++ および Python プログラムでは、外部の外部グラフィカルポストプロセッサを使用する必要があることに注意してください。また、汎用補間を使用して任意の数量を後処理できることにも注意してください(後述の <cite>ga_interpolation_Lagrange_fem</cite> を参照)。また、複雑なエクスポートやスライスを作成することもできます ( <a class="reference internal" href="../userdoc/export.html#ud-export"><em>解の出力と表示</em></a> をご覧ください)。</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">plain_vector</span> <span class="nf">U</span><span class="p">(</span><span class="n">mfu</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span> <span class="n">gmm</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="n">real_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">),</span> <span class="n">U</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">V</span><span class="p">(</span><span class="n">mft</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span> <span class="n">gmm</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="n">real_variable</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">),</span> <span class="n">V</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">THETA</span><span class="p">(</span><span class="n">mft</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span> <span class="n">gmm</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="n">real_variable</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">),</span><span class="n">THETA</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">VM</span><span class="p">(</span><span class="n">mfvm</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">compute_isotropic_linearized_Von_Mises_or_Tresca</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;clambdastar&quot;</span><span class="p">,</span> <span class="s">&quot;cmu&quot;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">CO</span><span class="p">(</span><span class="n">mfvm</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">ga_interpolation_Lagrange_fem</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&quot;*Grad_V&quot;</span><span class="p">,</span>  <span class="n">mfvm</span><span class="p">,</span> <span class="n">CO</span><span class="p">);</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp</span><span class="p">(</span><span class="s">&quot;displacement_with_von_mises.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mfu</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mfu</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&quot;elastostatic displacement&quot;</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="s">&quot;Von Mises stress&quot;</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">You can view solutions with for instance:</span><span class="se">\n\n</span><span class="s">mayavi2 &quot;</span>
  <span class="s">&quot;-d displacement_with_von_mises.vtk -f WarpVector -m Surface</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp2</span><span class="p">(</span><span class="s">&quot;temperature.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp2</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mft</span><span class="p">);</span>
<span class="n">exp2</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&quot;Temperature&quot;</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;mayavi2 -d temperature.vtk -f WarpScalar -m Surface</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp3</span><span class="p">(</span><span class="s">&quot;electric_potential.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp3</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mft</span><span class="p">);</span>
<span class="n">exp3</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&quot;Electric potential&quot;</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;mayavi2 -d electric_potential.vtk -f WarpScalar -m Surface</span><span class="se">\n</span><span class="s">&quot;</span>
     <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">U</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">)</span>
<span class="n">THETA</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">VM</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">compute_isotropic_linearized_Von_Mises_or_Tresca</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">)</span>
<span class="n">CO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">md</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Grad_V&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">mfvm</span><span class="o">.</span><span class="n">nbdof</span><span class="p">()),</span> <span class="s">&#39;F&#39;</span><span class="p">)</span>

<span class="n">mfvm</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;displacement_with_von_mises.vtk&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">,</span>
                   <span class="n">VM</span><span class="p">,</span> <span class="s">&#39;Von Mises Stresses&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;Displacements&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;You can view solutions with for instance:&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;mayavi2 -d displacement_with_von_mises.vtk -f WarpVector -m Surface&#39;</span><span class="p">)</span>
<span class="n">mft</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;temperature.vtk&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;mayavi2 -d temperature.vtk -f WarpScalar -m Surface&#39;</span><span class="p">)</span>
<span class="n">mft</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;electric_potential.vtk&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&#39;Electric potential&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;mayavi2 -d electric_potential.vtk -f WarpScalar -m Surface&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">U</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">V</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">THETA</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">VM</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;compute_isotropic_linearized_Von_Mises_or_Tresca&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">);</span>
<span class="n">CO</span> <span class="p">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;interpolation&#39;</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Grad_V&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span> <span class="n">gf_mesh_fem_get</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;nbdof&#39;</span><span class="p">)]);</span>

<span class="n">hh</span> <span class="p">=</span> <span class="n">scf</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">hh</span><span class="p">.</span><span class="n">color_map</span> <span class="p">=</span> <span class="n">jetcolormap</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">VM</span><span class="p">),</span><span class="n">max</span><span class="p">(</span><span class="n">VM</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Von Mises stress in N/cm^2 (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">drawlater</span><span class="p">;</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">V</span><span class="p">),</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">));</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">CO</span><span class="p">,</span> <span class="s">&#39;quiver&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;quiver_density&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="c">...</span>
        <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Electric potential in Volt (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">THETA</span><span class="p">),</span><span class="n">max</span><span class="p">(</span><span class="n">THETA</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Temperature in °C (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">U</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">V</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">THETA</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">VM</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;compute_isotropic_linearized_Von_Mises_or_Tresca&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">);</span>
<span class="n">CO</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;interpolation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;-&#39;</span> <span class="n">sigmaeps</span> <span class="s">&#39;*Grad_V&#39;</span><span class="p">],</span> <span class="n">mfvm</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span> <span class="n">gf_mesh_fem_get</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;nbdof&#39;</span><span class="p">)]);</span>

<span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Von Mises stress in N/cm^2 (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">CO</span><span class="p">,</span> <span class="s">&#39;quiver&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;quiver_density&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="c">...</span>
        <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Electric potential in Volt (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">off</span><span class="p">;</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Temperature in ?C (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="tut-fig-solthermo">
<a class="reference internal image-reference" href="../images/solution_thermo.png"><img alt="../images/solution_thermo.png" src="../images/solution_thermo.png" style="width: 774.0px; height: 796.0px;" /></a>
<p class="caption">解のプロット。</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="../index.html">
    <img class="logo" src="../static/logo_getfem_small.png" alt="Logo"/>
  </a></p>
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">熱および電気弾性連成の例 (単純な非線形結合問題、モデルオブジェクト、汎用アセンブリ、解析および可視化)</a><ul>
<li><a class="reference internal" href="#the-problem-setting">問題の設定</a><ul>
<li><a class="reference internal" href="#thermal-problem">熱問題</a></li>
<li><a class="reference internal" href="#electric-potential-problem">電位問題</a></li>
<li><a class="reference internal" href="#deformation-problem">変形問題</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-weak-formulation">弱定式化</a></li>
<li><a class="reference internal" href="#implementation-in-c-and-with-the-interface">C++ での実装とインターフェイス</a><ul>
<li><a class="reference internal" href="#initialization">初期化</a></li>
<li><a class="reference internal" href="#parameters-of-the-model">モデルのパラメータ</a></li>
<li><a class="reference internal" href="#mesh-generation">メッシュ生成</a></li>
<li><a class="reference internal" href="#boundary-selection">境界の選択</a></li>
<li><a class="reference internal" href="#mesh-draw">メッシュ描画</a></li>
<li><a class="reference internal" href="#definition-of-finite-element-methods-and-integration-method">有限要素法の定義と積分法</a></li>
<li><a class="reference internal" href="#model-definition">モデル定義</a></li>
<li><a class="reference internal" href="#membrane-elastic-deformation-problem">弾性膜変形問題</a></li>
<li><a class="reference internal" href="#id1">電位問題</a></li>
<li><a class="reference internal" href="#id2">熱問題</a></li>
<li><a class="reference internal" href="#model-solve">モデル求解</a></li>
<li><a class="reference internal" href="#model-solve-with-two-steps">モデルは2つのステップで解きます</a></li>
<li><a class="reference internal" href="#export-visualization-of-the-solution">解のエクスポート/可視化</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="basic_usage.html"
                        title="前の章へ"><em>GetFEM++</em> の基本的な使い方</a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="wheel.html"
                        title="次の章へ">接触する車輪の例 (2つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)</a></p>            <h3>Download</h3>
            <p><a href="../download.html">Download GetFEM++ </a></p>
	    <h3>Main documentations</h3>
	    <ul>
              
	      <li><a href="../userdoc/index.html">GetFEM++ User documentation</a></li>
              <li><a href="../python/index.html">Python Interface</a></li>
	      <li><a href="../matlab/index.html">Matlab Interface</a></li>
	      <li><a href="../scilab/index.html">Scilab Interface</a></li>
	      <li><a href="../gmm/index.html"> Gmm++</a></li>
	      <li><a href="../project/index.html"> GetFEM++ project</a></li>
            </ul>

            <h3>Other resources</h3>
            <ul>
              <li><a href="../screenshots/shots.html">Screenshots</a></li>
              <li><a href="../links.html">Related links</a></li>
	      <li><a href="https://savannah.nongnu.org/projects/getfem">Hosted by Savannah </a></li>
              
              
            </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="wheel.html" title="接触する車輪の例 (2つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)"
             >次へ</a> |</li>
        <li class="right" >
          <a href="basic_usage.html" title="GetFEM++ の基本的な使い方"
             >前へ</a> |</li>
        <li><a href="https://savannah.nongnu.org/projects/getfem" <img src="../static/icon.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li></a>
        <li><a href="../index.html">GetFEM++</a> &raquo;</li>

          <li><a href="index.html" ><em>GetFEM++</em> の導入</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2004-2017 GetFEM++ project.
    </div>
  </body>
</html>