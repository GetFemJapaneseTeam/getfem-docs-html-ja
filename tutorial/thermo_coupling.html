<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>熱弾性と電気的結合の例 (単純な非線形結合問題、モデルオブジェクト、汎用アセンブリ、解析と視覚化) &mdash; GetFEM++</title>
    
    <link rel="stylesheet" href="../static/getfem.css" type="text/css" />
    <link rel="stylesheet" href="../static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.3',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../static/jquery.js"></script>
    <script type="text/javascript" src="../static/underscore.js"></script>
    <script type="text/javascript" src="../static/doctools.js"></script>
    <script type="text/javascript" src="../static/translations.js"></script>
    <link rel="shortcut icon" href="../static/favicon.ico"/>
    <link rel="author" title="このドキュメントについて" href="../about.html" />
    <link rel="copyright" title="著作権" href="../copyright.html" />
    <link rel="top" title="GetFEM++" href="../index.html" />
    <link rel="up" title="|gf|チュートリアル" href="index.html" />
    <link rel="next" title="接触中のホイールの例 (2 つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)" href="wheel.html" />
    <link rel="prev" title="Basic Usage of GetFEM++" href="basic_usage.html" />
    <link rel="shortcut icon" type="image/png" href="../static/icon.png" />
 

  </head>
  <body>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             accesskey="I">索引</a></li>
        <li class="right" >
          <a href="wheel.html" title="接触中のホイールの例 (2 つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)"
             accesskey="N">次へ</a> |</li>
        <li class="right" >
          <a href="basic_usage.html" title="Basic Usage of GetFEM++"
             accesskey="P">前へ</a> |</li>
        <li><a href="https://savannah.nongnu.org/projects/getfem" <img src="../static/icon.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li></a>
        <li><a href="../index.html">GetFEM++</a> &raquo;</li>

          <li><a href="index.html" accesskey="U">|gf|チュートリアル</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="example-of-thermo-elastic-and-electrical-coupling-simple-nonlinear-coupled-problem-model-object-generic-assembly-solve-and-visualization">
<span id="tut-thermo-elec-coupling"></span><h1>熱弾性と電気的結合の例 (単純な非線形結合問題、モデルオブジェクト、汎用アセンブリ、解析と視覚化)<a class="headerlink" href="#example-of-thermo-elastic-and-electrical-coupling-simple-nonlinear-coupled-problem-model-object-generic-assembly-solve-and-visualization" title="このヘッドラインへのパーマリンク">¶</a></h1>
<p>この例は、変位場、温度場、電位場の非線形結合を持つマルチフィジックス問題の簡単な例を示すことを目的としています。また、C++ ライブラリと異なるインターフェイスの使用を比較することも目的としています。対応するデモファイルは、| gf のテストディレクトリに存在している <a href="#id1"><span class="problematic" id="id2">|</span></a>(&#8216; テスト/&#8217;、&#8217; インターフェイス/テスト/python &#8216;、&#8217; インターフェイス/scr/scilab/デモ &#8216; と &#8216; インターフェイス/テスト/matlab の &#8216;)。</p>
<div class="section" id="the-problem-setting">
<h2>問題の設定<a class="headerlink" href="#the-problem-setting" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>Let: 数学: &#8216; Omega subset R ^ 2 &#8216; は、2d プレートの参照構成になります (ジオメトリを参照してください: ref: &#8216; ここ&lt;tut-fig-meshthermo&gt;&#8217;) 厚さの: 数学: &#8216; varepsilon &#8216; 外部の力に提出, 電位と加熱.我々は、によって示されます: 数学: &#8216; theta: Omega rightarrow R &#8216; 温度フィールド (in | degreC <a href="#id1"><span class="problematic" id="id2">|</span></a>),: 数学: &#8216; V: Omega rightarrow R &#8216; 電位場と: 数学: &#8216; u: Omega rightarrow R ^ 2 &#8216; 膜変位場.&lt;/tut-fig-meshthermo&gt;</p>
<div class="section" id="thermal-problem">
<h3>熱問題<a class="headerlink" href="#thermal-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>プレートの正面と裏面が熱伝達係数: 数学: &#8216;d &#8216; で、空気 (20 | degreC <a href="#id1"><span class="problematic" id="id2">|</span></a>) との熱交換であることになっているので、プレートの外側の面は、断熱材になることになっている。</p>
<p>温度の方程式: 数学: &#8216; theta &#8216; と境界条件は、次のように記述することができます:</p>
<div class="math">
<p><img src="../images/math/21f096380e3c73a1f4556157ed61ae2993aab0e4.png" alt="\left\{\begin{array}{l}
-\mbox{div}(\varepsilon\kappa(\nabla \theta)) + 2D(\theta - T_0) - \varepsilon\sigma|\nabla V|^2 = 0 ~~ \mbox{ in } \Omega, \\
\kappa\nabla \theta \cdot n = 0 ~~ \mbox{ on } \partial \Omega,
\end{array} \right."/></p>
</div><p>熱伝導率が設計されている場所: 数学: &#8216; kappa &#8216;,: 数学: &#8216; t _0 &#8216; は、空気の温度です: 数学: &#8216; partial Omega &#8216; ドメインの境界: 数学: &#8216; Omega &#8216; と: 数学: &#8216; n &#8216; 外向きの単位法線ベクトル: 数学: &#8216; Omega &#8216; on: 数学: &#8216; partial Omega`.</p>
<p>用語: 数学: &#8216; sigma | nabla V | ^ 2 &#8216; は、ジュール加熱項に対応する非線形結合項であり、ここで: 数学: &#8216; sigma &#8216; は電気伝導度である。</p>
</div>
<div class="section" id="electric-potential-problem">
<h3>電気電位問題<a class="headerlink" href="#electric-potential-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>我々は、潜在的な違いを考慮: 数学: プレートの右と左の横面の間に &#8216; 0.1 v &#8216;。他の面は電気的に絶縁されていると見なされます。電気潜在性のための同等化はように読む</p>
<div class="math">
<p><img src="../images/math/228d208aa67c1abbda089d030b386cfa28058a09.png" alt="\left\{\begin{array}{l}
-\mbox{div}(\varepsilon\sigma(\nabla V)) = 0 ~~ \mbox{ in } \Omega, \\
\sigma\nabla V \cdot n = 0 ~~ \mbox{ on the top an bottom lateral faces}, \\
V = 0 ~~ \mbox{ on the right lateral face}, \\
V = 0.1 ~~ \mbox{ on the left lateral face}, \\
\end{array} \right."/></p>
</div><p>場所: 数学: &#8216; sigma &#8216; はまだ電気伝導性である。また、我々は考慮: 数学: &#8216; sigma は、次のように温度に依存:</p>
<div class="math">
<p><img src="../images/math/1fcd45830529fae6543dd7e3604b74c2e8355a99.png" alt="\sigma = \Frac{1}{\rho_0(1+\alpha(\theta - T_0))},"/></p>
</div><p>場所: 数学: &#8216; t _0 &#8216; 参照温度 (気温はここ)、: 数学: &#8216; rho_0 &#8216; 抵抗温度係数: 数学: &#8216; t _0 &#8216; と: 数学: &#8216; alpha &#8216; 2 番目の抵抗温度係数。</p>
</div>
<div class="section" id="deformation-problem">
<h3>変形問題<a class="headerlink" href="#deformation-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>我々は、右側の横面に適用される力の下でプレートの膜小さな変形を考慮し、プレートの加熱によって影響を受けた。変位: 数学: &#8216; u &#8216; は次の問題 (線形化された弾力性) の解決である:</p>
<div class="math">
<p><img src="../images/math/6e21f54c88108e97c48123fa3e4a5694ac874395.png" alt="\left\{\begin{array}{l}
-\mbox{div}(\bar{\sigma}(u)) = 0 ~~ \mbox{ in } \Omega, \\
\bar{\sigma}\ n = 0 ~~ \mbox{ on the top an bottom lateral faces}, \\
\bar{\sigma}\ n = F ~~ \mbox{ on the right lateral face}, \\
u = 0 ~~ \mbox{ on the left lateral face},
\end{array} \right."/></p>
</div><p>場所: 数学: &#8216; F &#8216; は、右横方向の境界に適用される力密度であり、: 数学: &#8216; bar{sigma} (u) &#8216; はコーシー応力テンソルで定義されています</p>
<div class="math">
<p><img src="../images/math/a7351de7f14eb96bd24887fefeafc27fcea4c1e5.png" alt="\bar{\sigma}(u) = \lambda^* \mbox{div}(u) I + 2\mu \bar{\varepsilon}(u) + \beta(T_0-\theta) I,"/></p>
</div><p>: 数学: &#8216; bar{varepsilon} (u) = (nabla u + (nabla u) ^ T)/2 &#8216; 線形ひずみテンソルである,: 数学: &#8216; I &#8216; アイデンティティ2番目の順序テンソルと: 数学: &#8216; lambda ^ <a href="#id1"><span class="problematic" id="id2">*</span></a>, μ &#8216; されて <a href="#id3"><span class="problematic" id="id4">|</span></a>ラメ <a href="#id5"><span class="problematic" id="id6">|</span></a>によって定義される係数</p>
<div class="math">
<p><img src="../images/math/06d7859343b74ef363af001d62ccd17f7d7434e1.png" alt="&amp;\lambda = \Frac{E\nu}{(1+\nu)(1-2\nu)}, \\
&amp;\mu = \Frac{E}{2(1+\nu)}, \\
&amp;\lambda^* = \Frac{2\lambda\mu}{\lambda+2*\mu},"/></p>
</div><p>から: 数学: &#8216; E &#8216; 若い係数と: 数学: &#8216; nu &#8216; 材料のポアソン比。</p>
<p>用語: 数学: &#8216; beta (T_0-theta) I &#8216; は、熱膨張の用語に対応しています, ここで: 数学: &#8216; beta = alpha_{th} E/(1-2 nu) &#8216;,: 数学: &#8216; alpha_{th} &#8216; 熱膨張係数である.</p>
</div>
</div>
<div class="section" id="the-weak-formulation">
<h2>弱い定式化<a class="headerlink" href="#the-weak-formulation" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>重要なステップは式の結合されたシステムの弱い定式化を得ることである。これは、有限要素の定式化は、弱い定式化 (ガラーキン近似) に基づいており、弱い定式化は、私たちに追加する用語の表現を与えることができる唯一のものであるため、重要なステップです。</p>
<p>各偏微分方程式の弱定式化は、主未知がディリクレ条件を満たす主な未知を満たす均質ディリクレ条件に対応する試験関数と式とを乗算したものであり、その後ドメイン上の統合: 数学: &#8216; Omega &#8216; と部品 (グリーンの式を使用して) によっていくつかの統合を実行します。部分的な微分方程式のシステムの弱い定式化は読む:</p>
<div class="math">
<p><img src="../images/math/07635cc1ae68c52b7548f1a5508d9768c3c5b199.png" alt="&amp;\mbox{Find } \theta, V, u \mbox{ with } V = 0.1, u = 0 \mbox{ on the left face}, V = 0 \mbox{ on the right face}, \\
&amp;\ds \int_{\Omega} \varepsilon\kappa\nabla\theta\cdot\nabla\delta_{\theta} + 2D\theta\delta_{\theta}dx = \int_{\Omega} (2DT_0 + \varepsilon\sigma|\nabla V|^2)\delta_{\theta} dx ~~~\mbox{ for all } \delta_{\theta}, \\
&amp;\ds \int_{\Omega} \varepsilon\sigma\nabla V\cdot\nabla\delta_V = 0 dx ~~~ \mbox{ for all } \delta_V \mbox{ satisfying } \delta_V = 0 \mbox{ on the left and right faces}, \\
&amp;\ds \int_{\Omega} \bar{\sigma}(u):\bar{\varepsilon}(\delta_u)dx = \int_{\Gamma_N} F\cdot \delta_u d\Gamma ~~~ \mbox{ for all } \delta_{u} \mbox{ satisfying } \delta_u = 0 \mbox{ on the left face},"/></p>
</div><p>場所: 数学: &#8216; delta_{theta}, delta_V, delta_u &#8216; に対応するテスト関数があります: 数学: &#8216; theta, V, u &#8216;, それぞれ,: 数学: &#8216; Gamma_N &#8216; 右の境界を示しますここで、力の密度: 数学: &#8216; F &#8216; が適用され、: 数学: &#8216; bar{sigma}: bar{varepsilon} &#8216; は、2番目の順序テンソルの間のフロベニウススカラー積です。</p>
</div>
<div class="section" id="implementation-in-c-and-with-the-interface">
<h2>C++ での実装とインターフェイス<a class="headerlink" href="#implementation-in-c-and-with-the-interface" title="このヘッドラインへのパーマリンク">¶</a></h2>
<p>私たちは今の使用の詳細なプレゼンテーションをしてみましょう | gf <a href="#id1"><span class="problematic" id="id2">|</span></a>問題を近似する。我々は同時に、C++、Python、Scilab と Matlab のプログラムを構築します。Matlab および Scilab プログラムの場合、我々は、指向オブジェクトコマンドを使用しません (参照: &#8216; mlab-oocmd &#8216; どのようにそれらを使用する)</p>
<div class="section" id="initialization">
<h3>初期化<a class="headerlink" href="#initialization" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>まず、C++ では、モデルオブジェクト、ジェネリックアセンブリ、線形インターフェイス (メッシャー + +)、実験用のヘッダー、およびエクスポート機能に対して、特定の数のヘッダを含めるようにしています。Python の場合、これは簡単です | gf <a href="#id1"><span class="problematic" id="id2">|</span></a>グローバルにインポートすることができます (numpy もインポートする)。scilab について, ライブラリは、最初に scilab コンソールにロードされている (これはここで説明されていません) と Matlab 用, 何も必要ありません, を除いて &#8216; gf_workspace (&#8216; クリアすべて &#8216;) &#8216; すべてをクリアすることができます | gf <a href="#id3"><span class="problematic" id="id4">|</span></a>変数。</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="cp">#include &quot;getfem/getfem_model_solvers.h&quot;</span>
<span class="cp">#include &quot;getfem/getfem_export.h&quot;</span>
<span class="cp">#include &quot;gmm/gmm.h&quot;</span>
<span class="cp">#include &quot;getfem/getfem_mesher.h&quot;</span>
<span class="cp">#include &quot;getfem/getfem_generic_assembly.h&quot;</span>

<span class="k">using</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">size_type</span><span class="p">;</span>
<span class="k">using</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">base_node</span><span class="p">;</span>
<span class="k">using</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">base_small_vector</span><span class="p">;</span>
<span class="k">typedef</span> <span class="n">getfem</span><span class="o">::</span><span class="n">model_real_plain_vector</span> <span class="n">plain_vector</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">void</span><span class="p">)</span> <span class="p">{</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">getfem</span> <span class="kn">as</span> <span class="nn">gf</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_workspace</span><span class="p">(</span><span class="s">&#39;clear all&#39;</span><span class="p">);</span> <span class="o">//</span> <span class="n">In</span> <span class="k">case</span> <span class="n">of</span> <span class="n">multiple</span> <span class="n">runs</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_workspace</span><span class="p">(</span><span class="s">&#39;clear all&#39;</span><span class="p">);</span> <span class="c">% In case of multiple runs</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="parameters-of-the-model">
<h3>モデルのパラメータ<a class="headerlink" href="#parameters-of-the-model" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>ここで、問題の物理的および数値の異なるパラメータを定義してみましょう。スクリプト言語 (Python、Scilab、Matlab) には違いはありません。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="kt">double</span> <span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="c1">// Thickness of the plate (cm)</span>
<span class="kt">double</span> <span class="n">E</span> <span class="o">=</span> <span class="mf">21E6</span><span class="p">;</span>     <span class="c1">// Young Modulus (N/cm^2)</span>
<span class="kt">double</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>     <span class="c1">// Poisson ratio</span>
<span class="kt">double</span> <span class="n">clambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="kt">double</span> <span class="n">cmu</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">));</span>
<span class="kt">double</span> <span class="n">clambdastar</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">clambda</span><span class="o">*</span><span class="n">cmu</span><span class="o">/</span><span class="p">(</span><span class="n">clambda</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">cmu</span><span class="p">);</span>
<span class="kt">double</span> <span class="n">F</span> <span class="o">=</span> <span class="mf">100E2</span><span class="p">;</span>    <span class="c1">// Force density at the right boundary (N/cm^2)</span>
<span class="kt">double</span> <span class="n">kappa</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">;</span>   <span class="c1">// Thermal conductivity (W/(cm K))</span>
<span class="kt">double</span> <span class="n">D</span> <span class="o">=</span> <span class="mf">10.</span><span class="p">;</span>      <span class="c1">// Heat transfer coefficient (W/(K cm^2))</span>
<span class="kt">double</span> <span class="n">air_temp</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span><span class="c1">// Temperature of the air in oC.</span>
<span class="kt">double</span> <span class="n">alpha_th</span> <span class="o">=</span> <span class="mf">16.6E-6</span><span class="p">;</span> <span class="c1">// Thermal expansion coefficient (/K)</span>
<span class="kt">double</span> <span class="n">T0</span> <span class="o">=</span> <span class="mf">20.</span><span class="p">;</span>     <span class="c1">// Reference temperature in oC</span>
<span class="kt">double</span> <span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1.754E-8</span><span class="p">;</span> <span class="c1">// Resistance temperature coefficient at T0</span>
<span class="kt">double</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0039</span><span class="p">;</span> <span class="c1">// Second resistance temperature coefficient</span>

<span class="kt">double</span> <span class="n">h</span> <span class="o">=</span> <span class="mf">2.</span>        <span class="c1">// Approximate mesh size</span>
<span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span> <span class="n">elements_degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c1">// Degree of the finite element methods</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Scripts</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">epsilon</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">;</span> <span class="n">E</span> <span class="o">=</span> <span class="mf">21E6</span><span class="p">;</span> <span class="n">nu</span> <span class="o">=</span> <span class="mf">0.3</span><span class="p">;</span>
<span class="n">clambda</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="n">cmu</span> <span class="o">=</span> <span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">));</span>
<span class="n">clambdastar</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">clambda</span><span class="o">*</span><span class="n">cmu</span><span class="o">/</span><span class="p">(</span><span class="n">clambda</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">cmu</span><span class="p">);</span>
<span class="n">F</span> <span class="o">=</span> <span class="mf">100E2</span><span class="p">;</span> <span class="n">kappa</span> <span class="o">=</span> <span class="mf">4.</span><span class="p">;</span> <span class="n">D</span> <span class="o">=</span> <span class="mi">10</span><span class="p">;</span>
<span class="n">air_temp</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">alpha_th</span> <span class="o">=</span> <span class="mf">16.6E-6</span><span class="p">;</span>
<span class="n">T0</span> <span class="o">=</span> <span class="mi">20</span><span class="p">;</span> <span class="n">rho_0</span> <span class="o">=</span> <span class="mf">1.754E-8</span><span class="p">;</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.0039</span><span class="p">;</span>

<span class="n">h</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="n">elements_degree</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mesh-generation">
<h3>メッシュ生成<a class="headerlink" href="#mesh-generation" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p><em>GetFEM++</em> has some limited meshing facilities which are described here. We are going to use them. However, there is no guaranty of the quality and conformity of the obtained mesh, so it is better to verify the mesh if you use <em>GetFEM++</em> meshing facilities. You can also use external meshers (GiD or Gmsh for instance) and import them (see <a class="reference internal" href="../userdoc/bmesh.html#ud-load-save-mesh"><em>メッシュの保存とロード</em></a>).</p>
<p>領域の幾何学は3つの円形の穴が付いている長方形であるために仮定される (見なさい: ref: &#8216; ツタンカーメン-イチジク-meshthermo &#8216;)。ジオメトリは、いくつかの幾何学的プリミティブとユニオン/setminus 操作のおかげで記述されています (ファイル: &#8216; src/getfem/getfem) _mesher &#8216; ファイルを参照してください。以下では、&#8217; h &#8216; はメッシュサイズを表し、&#8217; 2 &#8216; はメッシュの次数である (これは、変形が次数2であることを意味し、我々は湾曲したエッジを使用した)。</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh</span> <span class="n">mesh</span><span class="p">;</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">pmesher_signed_distance</span>
<span class="n">mo1</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_rectangle</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="n">base_node</span><span class="p">(</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">)),</span>
<span class="n">mo2</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_ball</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span> <span class="mf">8.</span><span class="p">),</span>
<span class="n">mo3</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_ball</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span> <span class="mf">8.</span><span class="p">),</span>
<span class="n">mo4</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_ball</span><span class="p">(</span><span class="n">base_node</span><span class="p">(</span><span class="mf">75.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">),</span> <span class="mf">8.</span><span class="p">),</span>
<span class="n">mo5</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_union</span><span class="p">(</span><span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">),</span>
<span class="n">mo</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">new_mesher_setminus</span><span class="p">(</span><span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">);</span>

<span class="n">std</span><span class="o">::</span><span class="n">vector</span><span class="o">&lt;</span><span class="n">getfem</span><span class="o">::</span><span class="n">base_node</span><span class="o">&gt;</span> <span class="n">fixed</span><span class="p">;</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">build_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="n">fixed</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">mo1</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="mf">100.</span><span class="p">,</span> <span class="mf">25.</span><span class="p">])</span>
<span class="n">mo2</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">25.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">mo3</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">50.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">mo4</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">75.</span><span class="p">,</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">mo5</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;union&#39;</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">)</span>
<span class="n">mo</span>  <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MesherObject</span><span class="p">(</span><span class="s">&#39;set minus&#39;</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">)</span>

<span class="n">mesh</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">Mesh</span><span class="p">(</span><span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mo1</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">25</span><span class="p">]);</span>
<span class="n">mo2</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo3</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo4</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo5</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;union&#39;</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">);</span>
<span class="n">mo</span>  <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;set minus&#39;</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">);</span>

<span class="n">mesh</span> <span class="p">=</span> <span class="n">gf_mesh</span><span class="p">(</span><span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mo1</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;rectangle&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">100</span> <span class="mi">25</span><span class="p">]);</span>
<span class="n">mo2</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">25</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo3</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo4</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;ball&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">75</span> <span class="mf">12.5</span><span class="p">],</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">mo5</span> <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;union&#39;</span><span class="p">,</span> <span class="n">mo2</span><span class="p">,</span> <span class="n">mo3</span><span class="p">,</span> <span class="n">mo4</span><span class="p">);</span>
<span class="n">mo</span>  <span class="p">=</span> <span class="n">gf_mesher_object</span><span class="p">(</span><span class="s">&#39;set minus&#39;</span><span class="p">,</span> <span class="n">mo1</span><span class="p">,</span> <span class="n">mo5</span><span class="p">);</span>

<span class="n">mesh</span> <span class="p">=</span> <span class="n">gf_mesh</span><span class="p">(</span><span class="s">&#39;generate&#39;</span><span class="p">,</span> <span class="n">mo</span><span class="p">,</span> <span class="n">h</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="tut-fig-meshthermo">
<a class="reference internal image-reference" href="../images/mesh_thermo.png"><img alt="../images/mesh_thermo.png" src="../images/mesh_thermo.png" style="width: 975.0px; height: 344.0px;" /></a>
<p class="caption">得られたメッシュ。</p>
</div>
</div>
<div class="section" id="boundary-selection">
<h3>境界の選択<a class="headerlink" href="#boundary-selection" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>我々は境界の異なる部分に異なる境界条件を持っているので、我々は、境界の異なる部分 (穴、熱と電気絶縁と一緒にストレスフリーの境界条件が想定されている) に番号を付けなければならない。したがって、我々は、メッシュ上の要素面を選択し、メッシュ領域を定義する必要があります (参照: &#8216; ud-mesh_regions &#8216;) 1, 2, 3, 4 は、右の境界、左の1つ、上の1つと下の1つそれぞれである。これらの境界番号は、モデルのレンガで使用されます。</p>
<table border="1" class="longtable docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">border_faces</span><span class="p">;</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">outer_faces_of_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb1</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_in_box</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span> <span class="n">base_node</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">),</span>
                 <span class="n">base_node</span><span class="p">(</span><span class="mf">99.</span><span class="p">,</span> <span class="mf">24.</span><span class="p">));</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb2</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb3</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb4</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span> <span class="n">fb5</span>
  <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">select_faces_of_normal</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">border_faces</span><span class="p">,</span>
                     <span class="n">base_small_vector</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">),</span> <span class="mf">0.01</span><span class="p">);</span>

<span class="n">size_type</span> <span class="n">RIGHT_BOUND</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">TOP_BOUND</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span> <span class="n">RIGHT_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb2</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span>  <span class="n">LEFT_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb3</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span>   <span class="n">TOP_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb4</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">mesh</span><span class="p">.</span><span class="n">region</span><span class="p">(</span><span class="n">BOTTOM_BOUND</span><span class="p">)</span> <span class="o">=</span> <span class="n">getfem</span><span class="o">::</span><span class="n">mesh_region</span><span class="o">::</span><span class="n">subtract</span><span class="p">(</span><span class="n">fb5</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">fb1</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_in_box</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span><span class="p">],</span> <span class="p">[</span><span class="mf">99.</span><span class="p">,</span> <span class="mf">24.</span><span class="p">])</span>
<span class="n">fb2</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fb3</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fb4</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span>  <span class="mf">1.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>
<span class="n">fb5</span> <span class="o">=</span> <span class="n">mesh</span><span class="o">.</span><span class="n">outer_faces_with_direction</span><span class="p">([</span><span class="mf">0.</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">)</span>

<span class="n">RIGHT_BOUND</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">LEFT_BOUND</span><span class="o">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">TOP_BOUND</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">BOTTOM_BOUND</span><span class="o">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">HOLE_BOUND</span><span class="o">=</span><span class="mi">5</span><span class="p">;</span>

<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span> <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">fb2</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span>  <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">fb3</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span>   <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">fb4</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span><span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">fb5</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">set_region</span><span class="p">(</span>  <span class="n">HOLE_BOUND</span><span class="p">,</span> <span class="n">fb1</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span> <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span>  <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span>   <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
<span class="n">mesh</span><span class="o">.</span><span class="n">region_subtract</span><span class="p">(</span><span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">fb1</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces in box&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">99</span> <span class="mi">24</span><span class="p">]);</span>
<span class="n">fb2</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb3</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb4</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span>  <span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb5</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>

<span class="n">RIGHT_BOUND</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">LEFT_BOUND</span><span class="p">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">TOP_BOUND</span><span class="p">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">BOTTOM_BOUND</span><span class="p">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">HOLE_BOUND</span><span class="p">=</span><span class="mi">5</span><span class="p">;</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">fb2</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">fb3</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">fb4</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">fb5</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">HOLE_BOUND</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">fb1</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces in box&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">99</span> <span class="mi">24</span><span class="p">]);</span>
<span class="n">fb2</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb3</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="mi">0</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb4</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span>  <span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>
<span class="n">fb5</span> <span class="p">=</span> <span class="n">gf_mesh_get</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;outer faces with direction&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="mf">0.01</span><span class="p">);</span>

<span class="n">RIGHT_BOUND</span><span class="p">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">LEFT_BOUND</span><span class="p">=</span><span class="mi">2</span><span class="p">;</span> <span class="n">TOP_BOUND</span><span class="p">=</span><span class="mi">3</span><span class="p">;</span> <span class="n">BOTTOM_BOUND</span><span class="p">=</span><span class="mi">4</span><span class="p">;</span> <span class="n">HOLE_BOUND</span><span class="p">=</span><span class="mi">5</span><span class="p">;</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">fb2</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">fb3</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">fb4</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">fb5</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region&#39;</span><span class="p">,</span>   <span class="n">HOLE_BOUND</span><span class="p">,</span> <span class="n">fb1</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>  <span class="n">RIGHT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>   <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span>    <span class="n">TOP_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
<span class="n">gf_mesh_set</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;region subtract&#39;</span><span class="p">,</span> <span class="n">BOTTOM_BOUND</span><span class="p">,</span> <span class="n">HOLE_BOUND</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="mesh-draw">
<h3>メッシュドロー<a class="headerlink" href="#mesh-draw" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>メッシュをプレビューし、その妥当性を制御するために、次の手順を使用することができます。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp</span><span class="p">(</span><span class="s">&quot;mesh.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mesh</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">write_mesh</span><span class="p">();</span>
<span class="c1">// You can view the mesh for instance with</span>
<span class="c1">// mayavi2 -d mesh.vtk -f ExtractEdges -m Surface</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">mesh</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;mesh.vtk&#39;</span><span class="p">);</span>
<span class="c"># You can view the mesh for instance with</span>
<span class="c"># mayavi2 -d mesh.vtk -f ExtractEdges -m Surface</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">scf</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gf_plot_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&#39;curved&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;regions&#39;</span><span class="p">,</span> <span class="c">...</span>
             <span class="p">[</span><span class="n">RIGHT_BOUND</span> <span class="n">LEFT_BOUND</span> <span class="n">TOP_BOUND</span> <span class="n">BOTTOM_BOUND</span><span class="p">]);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Mesh&#39;</span><span class="p">);</span>
<span class="n">sleep</span><span class="p">(</span><span class="mi">1000</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_plot_mesh</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="s">&#39;curved&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;regions&#39;</span><span class="p">,</span> <span class="c">...</span>
             <span class="p">[</span><span class="n">RIGHT_BOUND</span> <span class="n">LEFT_BOUND</span> <span class="n">TOP_BOUND</span> <span class="n">BOTTOM_BOUND</span><span class="p">]);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Mesh&#39;</span><span class="p">);</span>
<span class="n">pause</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>C++ および Python インターフェイスでは、外部のグラフィカルポストプロセッサを使用する (たとえば、gmsh、Mayavi2、または Paraview) ことがあります。Scilab および Matlab インタフェースでは、内部プロット機能を使用することができます (結果を参照してください: ref: &#8216; ツタンカーメン-イチジク-meshthermo &#8216;)。</p>
</div>
<div class="section" id="definition-of-finite-element-methods-and-integration-method">
<h3>有限要素法の定義と積分法<a class="headerlink" href="#definition-of-finite-element-methods-and-integration-method" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>3つの有限要素法を定義する。最初の1つ、&#8217; mfu &#8216; は変位場を近似することです。これはベクトルフィールドです。これは C++ で定義されます。</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mfu</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">mfu</span><span class="p">.</span><span class="n">set_classical_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>
</pre></div>
</div>
<p>ここで、&#8217; 2 &#8216; はベクトルフィールドの次元を表します。2行目は、使用される有限要素を設定します。&#8217; classical_finite_element &#8216; は連続したラグランジュ要素を意味し、&#8217; elements_degree &#8216; が &#8216; 2 &#8216; に設定されていることを覚えておいて、二次 (アイソパラメトリック) 要素を使用することを意味します。</p>
<p>既存の有限要素法の幅広い選択肢があります | gf <a href="#id1"><span class="problematic" id="id2">|</span></a>, 参照してください: ref: &#8216; ud-appendixa &#8216;.しかし、ラグランジュ有限要素法は、実際に最も使用されています。</p>
<p>第2の有限要素法はスカラー 1, &#8216; mft &#8216; で、温度場と電位場の両方を近似する。単一の有限要素法は、有限要素変数の任意の数を近似するために役立つことができます。</p>
<p>第3の有限要素法は不連続スカラーラグランジュ1つであり、変数の1つの導関数を補間することができる (例えば、フォン・ミーゼスストレスを補間する)。</p>
<p>最後に定義することは、積分法 &#8216; mim &#8216; です。デフォルトの統合方法はありません | gf <a href="#id1"><span class="problematic" id="id2">|</span></a>したがって、積分法を定義することは必須です。もちろん、選択した有限要素法を簡便に統合するには、積分法の次数を十分に選択しなければならない。ここでは、&#8217; elements_degree &#8216; の二乗で十分です。</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mfu</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">mfu</span><span class="p">.</span><span class="n">set_classical_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mft</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">mft</span><span class="p">.</span><span class="n">set_classical_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_fem</span> <span class="n">mfvm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">mfvm</span><span class="p">.</span><span class="n">set_classical_discontinuous_finite_element</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">);</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">mesh_im</span>  <span class="n">mim</span><span class="p">(</span><span class="n">mesh</span><span class="p">);</span>
<span class="n">mim</span><span class="p">.</span><span class="n">set_integration_method</span><span class="p">(</span><span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">gmm</span><span class="o">::</span><span class="n">sqr</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)));</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">mfu</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshFem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">mfu</span><span class="o">.</span><span class="n">set_classical_fem</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)</span>
<span class="n">mft</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshFem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mft</span><span class="o">.</span><span class="n">set_classical_fem</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)</span>
<span class="n">mfvm</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshFem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">mfvm</span><span class="o">.</span><span class="n">set_classical_discontinuous_fem</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">)</span>
<span class="n">mim</span> <span class="o">=</span> <span class="n">gf</span><span class="o">.</span><span class="n">MeshIm</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="n">elements_degree</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mfu</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mft</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mfvm</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;classical discontinuous fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">mim</span> <span class="p">=</span> <span class="n">gf_mesh_im</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">elements_degree</span>^<span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">mfu</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mft</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="s">&#39;classical fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="p">);</span>
<span class="n">mfvm</span> <span class="p">=</span> <span class="n">gf_mesh_fem</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="n">gf_mesh_fem_set</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;classical discontinuous fem&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
<span class="n">mim</span> <span class="p">=</span> <span class="n">gf_mesh_im</span><span class="p">(</span><span class="n">mesh</span><span class="p">,</span> <span class="n">elements_degree</span>^<span class="mi">2</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="model-definition">
<h3>モデル定義<a class="headerlink" href="#model-definition" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>モデルオブジェクト | gf <a href="#id1"><span class="problematic" id="id2">|</span></a>モデルの変数 (未知数)、データ、およびモデルのレンガと呼ばれるものを収集します。モデルレンガは、1つの変数に適用されるモデル (線形または非線形の用語) の一部であるか、複数の変数をリンクしています。これらは、(接線) 線形システムのアセンブリを作成するために使用されます (詳細については、ref: &#8216; ud モデルオブジェクト &#8216; を参照してください)。</p>
<p>これは、モデルオブジェクトを使用するために厳密には必須ではありませんが、アセンブリプロシージャを直接使用し、(接線) 線形システムを独自に構築することができます。モデルオブジェクトは、モデルのほとんどの古典的な部分が事前にプログラムされているので、モデルのラピッドビルドを可能にする: 標準の境界条件、標準偏微分方程式、乗算器の使用は、制約を処方する...また、いくつかのレンガは、標準レンガの可能性を拡張するように設計されています (一般的なアセンブリのレンガ、明示的マトリックスレンガ...).したがって、モデルオブジェクトのフレームワークを使用することをお勧めします。</p>
<p>モデルの2つのバージョンがあります: 実際のものと複雑なもの。複雑なモデルは複雑な線形システムを解決するために有利である特殊アプリケーション (例えばいくつかの電磁気問題) のために予約されなければならない。</p>
<p>計算される3つのフィールドに対応する3つの変数を持つ実数モデルを宣言しましょう:</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">model</span> <span class="n">md</span><span class="p">;</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">=</span><span class="n">gf</span><span class="o">.</span><span class="n">Model</span><span class="p">(</span><span class="s">&#39;real&#39;</span><span class="p">);</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_fem_variable</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">md</span><span class="p">=</span><span class="n">gf_model</span><span class="p">(</span><span class="s">&#39;real&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">md</span><span class="p">=</span><span class="n">gf_model</span><span class="p">(</span><span class="s">&#39;real&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add fem variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="membrane-elastic-deformation-problem">
<h3>膜弾性変形問題<a class="headerlink" href="#membrane-elastic-deformation-problem" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>私たちは今、弾性変形の問題から始めましょう。我々は以下の &#8216; add_isotropic_linearized_elasticity_brick &#8216; によって追加された定義済みのレンガを使用します。基本的にそれはに対応する用語を追加します。</p>
<div class="math">
<p><img src="../images/math/b8a15b79aa8793124675da9b1c74bdb0a4191310.png" alt="\int_{\Omega} (\lambda^* \mbox{div}(u) I + 2\mu \bar{\varepsilon}(u)):\bar{\varepsilon}(\delta_u)dx,"/></p>
</div><p>を接線線形システムに対して行います。このモデルのレンガを使用するために, データは、彼に対応する <a href="#id1"><span class="problematic" id="id2">|</span></a>ラメ <a href="#id3"><span class="problematic" id="id4">|</span></a>係数は、最初にモデルに追加する必要があります。ここでは、<a href="#id5"><span class="problematic" id="id6">|</span></a>ラメ <a href="#id7"><span class="problematic" id="id8">|</span></a>係数はドメインに対して一定です。しかし、それはまた、いくつかの非定数データを定義することができます。また、この定義済みのブリックを使用する代わりに、弱い形式の言語用語 &#8216; add_linear_term (md mim、ラムダ * (Div_u * Div_Test_u) + mu * ((Grad_u + Grad_u &#8216;): Grad_Test_u) &#8220;を使用することもできます。</p>
<p>カップリング用語について</p>
<div class="math">
<p><img src="../images/math/2562e1e538a37c6d30d57352772d9a0d13364e59.png" alt="\int_{\Omega} (\beta\theta I) :\bar{\varepsilon}(\delta_u)dx,"/></p>
</div><p>定義済みの煉瓦がないし、私達は弱い形態の言語言葉の &#8216; add_linear_term (md の mim、「ベータ * シータ * Div_Test_u)」を直接使用する。参照: ref: &#8216; ud-gasm-高 &#8216; 弱いフォーム言語の詳細については。基本的に、アセンブリ文字列は、各ガウスポイントで実行される最適化されたアセンブリ命令のリストにコンパイルされることを原則としています。</p>
<p>次のプログラムは、全体の弾性変形方程式を考慮することができます。特定のレンガを使用して、左側の境界にディリクレ条件を規定することに注意してください。ディリクレ条件を処方するためのいくつかのオプションがあります (参照: &#8216; ud-モデル-ディリクレ &#8216;)。</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;cmu&quot;</span><span class="p">,</span> <span class="n">cmu</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;clambdastar&quot;</span><span class="p">,</span> <span class="n">clambdastar</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;T0&quot;</span><span class="p">,</span> <span class="n">T0</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_isotropic_linearized_elasticity_brick</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;clambdastar&quot;</span><span class="p">,</span> <span class="s">&quot;cmu&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_Dirichlet_condition_with_multipliers</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">LEFT_BOUND</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_fixed_size_data</span><span class="p">(</span><span class="s">&quot;Fdata&quot;</span><span class="p">,</span> <span class="n">base_small_vector</span><span class="p">(</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span><span class="mf">0.</span><span class="p">));</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;Fdata&quot;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>

<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;beta&quot;</span><span class="p">,</span> <span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">));</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_linear_term</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;beta*(T0-theta)*Div_Test_u&quot;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cmu</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">clambdastar</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;T0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">T0</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_isotropic_linearized_elasticity_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">)</span>

<span class="n">md</span><span class="o">.</span><span class="n">add_Dirichlet_condition_with_multipliers</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">)</span>

<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_linear_term</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;beta*(T0-theta)*Div_Test_u&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cmu</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">clambdastar</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;T0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">T0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add isotropic linearized elasticity brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add linear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;beta*(T0-theta)*Div_Test_u&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">cmu</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">clambdastar</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;T0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">T0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add isotropic linearized elasticity brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">F</span><span class="o">*</span><span class="n">epsilon</span><span class="p">,</span> <span class="mi">0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;Fdata&#39;</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;beta&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha_th</span><span class="o">*</span><span class="n">E</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add linear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;beta*(T0-theta)*Div_Test_u&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id1">
<h3>電気電位問題<a class="headerlink" href="#id1" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>同様に、次のプログラムは、電気ポテンシャル方程式を考慮してください。電気伝導度の定義に注意してください: 数学: &#8216; sigma &#8216; と、再び弱いフォーム言語用語の使用.</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">std</span><span class="o">::</span><span class="n">string</span> <span class="n">sigmaeps</span> <span class="o">=</span> <span class="s">&quot;(eps/(rho_0*(1+alpha*(theta-T0))))&quot;</span><span class="p">;</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;eps&quot;</span><span class="p">,</span> <span class="n">epsilon</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;rho_0&quot;</span><span class="p">,</span> <span class="n">rho_0</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;alpha&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_nonlinear_term</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">sigmaeps</span><span class="o">+</span><span class="s">&quot;*(Grad_V.Grad_Test_V)&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_Dirichlet_condition_with_multipliers</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;DdataV&quot;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_Dirichlet_condition_with_multipliers</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;V&quot;</span><span class="p">,</span> <span class="n">bgeot</span><span class="o">::</span><span class="n">dim_type</span><span class="p">(</span><span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&quot;DdataV&quot;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">sigmaeps</span> <span class="o">=</span> <span class="s">&#39;(eps/(rho_0*(1+alpha*(theta-T0))))&#39;</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;rho_0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_0</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_nonlinear_term</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*(Grad_V.Grad_Test_V)&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_Dirichlet_condition_with_multipliers</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;DdataV&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_Dirichlet_condition_with_multipliers</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">sigmaps</span> <span class="p">=</span> <span class="s">&#39;(eps/(rho_0*(1+alpha*(theta-T0))))&#39;</span><span class="p">;</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;rho_0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*(Grad_V.Grad_Test_V)&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">sigmaps</span> <span class="p">=</span> <span class="s">&#39;(eps/(rho_0*(1+alpha*(theta-T0))))&#39;</span><span class="p">;</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;eps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;rho_0&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">rho_0</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;alpha&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">alpha</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="p">[</span><span class="n">sigmaeps</span> <span class="s">&#39;*(Grad_V.Grad_Test_V)&#39;</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">RIGHT_BOUND</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add Dirichlet condition with multipliers&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">,</span> <span class="n">elements_degree</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">LEFT_BOUND</span><span class="p">,</span> <span class="s">&#39;DdataV&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="id2">
<h3>熱問題<a class="headerlink" href="#id2" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>さて、プログラムのアカウントに熱の問題を取る:</p>
<table border="1" class="docutils">
<colgroup>
<col width="9%" />
<col width="91%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;kaeps&quot;</span><span class="p">,</span> <span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_generic_elliptic_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="s">&quot;kaeps&quot;</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;D2&quot;</span><span class="p">,</span> <span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">add_initialized_scalar_data</span><span class="p">(</span><span class="s">&quot;D2airt&quot;</span><span class="p">,</span> <span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_mass_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="s">&quot;D2&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;theta&quot;</span><span class="p">,</span> <span class="s">&quot;D2airt&quot;</span><span class="p">);</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">add_nonlinear_term</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&quot;*Norm_sqr(Grad_V)*Test_theta&quot;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;kaeps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_generic_elliptic_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;D2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_initialized_data</span><span class="p">(</span><span class="s">&#39;D2airt&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">])</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_mass_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">add_source_term_brick</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">)</span>

<span class="n">md</span><span class="o">.</span><span class="n">add_nonlinear_term</span><span class="p">(</span><span class="n">mim</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Norm_sqr(Grad_V)*Test_theta&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add generic elliptic brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add mass brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Norm_sqr(Grad_V)*Test_theta&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">kappa</span><span class="o">*</span><span class="n">epsilon</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add generic elliptic brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;kaeps&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add initialized data&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">,</span> <span class="p">[</span><span class="n">air_temp</span><span class="o">*</span><span class="n">D</span><span class="o">*</span><span class="mi">2</span><span class="p">]);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add mass brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add source term brick&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">,</span> <span class="s">&#39;D2airt&#39;</span><span class="p">);</span>

<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;add nonlinear term&#39;</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;-&#39;</span> <span class="n">sigmaeps</span> <span class="s">&#39;*Norm_sqr(Grad_V)*Test_theta&#39;</span><span class="p">]);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="model-solve">
<h3>モデルの解決<a class="headerlink" href="#model-solve" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>モデルが正しく定義されると、次のように単純に解決できます。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">gmm</span><span class="o">::</span><span class="n">iteration</span> <span class="n">iter</span><span class="p">(</span><span class="mf">1E-9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">standard_solve</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<p>この問題はグローバルに非線形であるため、ニュートン法を用いて問題を反復的に解くことができます。それはいくつかのイテレーション (約4その場合) が必要です。</p>
</div>
<div class="section" id="model-solve-with-two-steps">
<h3>2つのステップでモデルを解く<a class="headerlink" href="#model-solve-with-two-steps" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>問題を解決するもう一つの選択は熱および電気潜在的な問題を最初に解決することである。実際、我々のモデルでは、熱と電位は変形に依存しません。一度熱と電位の問題は、我々は、変形の問題を解決します。これは次のように行うことができます。</p>
<table border="1" class="docutils">
<colgroup>
<col width="12%" />
<col width="88%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">gmm</span><span class="o">::</span><span class="n">iteration</span> <span class="n">iter</span><span class="p">(</span><span class="mf">1E-9</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">standard_solve</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">enable_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">);</span>
<span class="n">md</span><span class="p">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">);</span>
<span class="n">iter</span><span class="p">.</span><span class="n">init</span><span class="p">();</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">standard_solve</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">iter</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">md</span><span class="o">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">enable_variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">disable_variable</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">)</span>
<span class="n">md</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;enable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;enable variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">gf_model_set</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;disable variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;solve&#39;</span><span class="p">,</span> <span class="s">&#39;max_res&#39;</span><span class="p">,</span> <span class="mf">1E-9</span><span class="p">,</span> <span class="s">&#39;max_iter&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;noisy&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="export-visualization-of-the-solution">
<h3>ソリューションのエクスポート/視覚化<a class="headerlink" href="#export-visualization-of-the-solution" title="このヘッドラインへのパーマリンク">¶</a></h3>
<p>有限要素問題が解決されました。我々は、次のようにソリューションをプロットすることができます。C++ および Python プログラムでは、外部の外部グラフィカルポストプロセッサを使用する必要があることに注意してください。また、任意の数量は、ジェネリック補間を使用して後処理することもできます (後述の「ga_interpolation_Lagrange_fem」を参照)。また、複雑なエクスポートとスライスを作成することもできます (参照: &#8216; ud-エクスポート &#8216;)。</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><strong>C++</strong></td>
<td><div class="first last highlight-c++"><div class="highlight"><pre><span class="n">plain_vector</span> <span class="nf">U</span><span class="p">(</span><span class="n">mfu</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span> <span class="n">gmm</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="n">real_variable</span><span class="p">(</span><span class="s">&quot;u&quot;</span><span class="p">),</span> <span class="n">U</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">V</span><span class="p">(</span><span class="n">mft</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span> <span class="n">gmm</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="n">real_variable</span><span class="p">(</span><span class="s">&quot;V&quot;</span><span class="p">),</span> <span class="n">V</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">THETA</span><span class="p">(</span><span class="n">mft</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span> <span class="n">gmm</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">md</span><span class="p">.</span><span class="n">real_variable</span><span class="p">(</span><span class="s">&quot;theta&quot;</span><span class="p">),</span><span class="n">THETA</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">VM</span><span class="p">(</span><span class="n">mfvm</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">());</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">compute_isotropic_linearized_Von_Mises_or_Tresca</span>
  <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&quot;u&quot;</span><span class="p">,</span> <span class="s">&quot;clambdastar&quot;</span><span class="p">,</span> <span class="s">&quot;cmu&quot;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">plain_vector</span> <span class="nf">CO</span><span class="p">(</span><span class="n">mfvm</span><span class="p">.</span><span class="n">nb_dof</span><span class="p">()</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
<span class="n">getfem</span><span class="o">::</span><span class="n">ga_interpolation_Lagrange_fem</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&quot;-&quot;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&quot;*Grad_V&quot;</span><span class="p">,</span>  <span class="n">mfvm</span><span class="p">,</span> <span class="n">CO</span><span class="p">);</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp</span><span class="p">(</span><span class="s">&quot;displacement_with_von_mises.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mfu</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mfu</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&quot;elastostatic displacement&quot;</span><span class="p">);</span>
<span class="n">exp</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="s">&quot;Von Mises stress&quot;</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">You can view solutions with for instance:</span><span class="se">\n\n</span><span class="s">mayavi2 &quot;</span>
  <span class="s">&quot;-d displacement_with_von_mises.vtk -f WarpVector -m Surface</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp2</span><span class="p">(</span><span class="s">&quot;temperature.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp2</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mft</span><span class="p">);</span>
<span class="n">exp2</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&quot;Temperature&quot;</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;mayavi2 -d temperature.vtk -f WarpScalar -m Surface</span><span class="se">\n</span><span class="s">&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

<span class="n">getfem</span><span class="o">::</span><span class="n">vtk_export</span> <span class="n">exp3</span><span class="p">(</span><span class="s">&quot;electric_potential.vtk&quot;</span><span class="p">,</span> <span class="nb">false</span><span class="p">);</span>
<span class="n">exp3</span><span class="p">.</span><span class="n">exporting</span><span class="p">(</span><span class="n">mft</span><span class="p">);</span>
<span class="n">exp3</span><span class="p">.</span><span class="n">write_point_data</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&quot;Electric potential&quot;</span><span class="p">);</span>
<span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;mayavi2 -d electric_potential.vtk -f WarpScalar -m Surface</span><span class="se">\n</span><span class="s">&quot;</span>
     <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Python</strong></td>
<td><div class="first last highlight-python"><div class="highlight"><pre><span class="n">U</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">)</span>
<span class="n">V</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s">&#39;V&#39;</span><span class="p">)</span>
<span class="n">THETA</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">variable</span><span class="p">(</span><span class="s">&#39;theta&#39;</span><span class="p">)</span>
<span class="n">VM</span> <span class="o">=</span> <span class="n">md</span><span class="o">.</span><span class="n">compute_isotropic_linearized_Von_Mises_or_Tresca</span><span class="p">(</span><span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">)</span>
<span class="n">CO</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">md</span><span class="o">.</span><span class="n">interpolation</span><span class="p">(</span><span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Grad_V&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">mfvm</span><span class="o">.</span><span class="n">nbdof</span><span class="p">()),</span> <span class="s">&#39;F&#39;</span><span class="p">)</span>

<span class="n">mfvm</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;displacement_with_von_mises.vtk&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">,</span>
                   <span class="n">VM</span><span class="p">,</span> <span class="s">&#39;Von Mises Stresses&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;Displacements&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;You can view solutions with for instance:&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;mayavi2 -d displacement_with_von_mises.vtk -f WarpVector -m Surface&#39;</span><span class="p">)</span>
<span class="n">mft</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;temperature.vtk&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;mayavi2 -d temperature.vtk -f WarpScalar -m Surface&#39;</span><span class="p">)</span>
<span class="n">mft</span><span class="o">.</span><span class="n">export_to_vtk</span><span class="p">(</span><span class="s">&#39;electric_potential.vtk&#39;</span><span class="p">,</span> <span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&#39;Electric potential&#39;</span><span class="p">)</span>
<span class="k">print</span> <span class="p">(</span><span class="s">&#39;mayavi2 -d electric_potential.vtk -f WarpScalar -m Surface&#39;</span><span class="p">)</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-odd"><td><strong>Scilab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">U</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">V</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">THETA</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">VM</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;compute_isotropic_linearized_Von_Mises_or_Tresca&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">);</span>
<span class="n">CO</span> <span class="p">=</span> <span class="n">matrix</span><span class="p">(</span><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;interpolation&#39;</span><span class="p">,</span> <span class="s">&#39;-&#39;</span><span class="o">+</span><span class="n">sigmaeps</span><span class="o">+</span><span class="s">&#39;*Grad_V&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span> <span class="n">gf_mesh_fem_get</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;nbdof&#39;</span><span class="p">)]);</span>

<span class="n">hh</span> <span class="p">=</span> <span class="n">scf</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">hh</span><span class="p">.</span><span class="n">color_map</span> <span class="p">=</span> <span class="n">jetcolormap</span><span class="p">(</span><span class="mi">255</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">VM</span><span class="p">),</span><span class="n">max</span><span class="p">(</span><span class="n">VM</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Von Mises stress in N/cm^2 (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">drawlater</span><span class="p">;</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">V</span><span class="p">),</span><span class="n">max</span><span class="p">(</span><span class="n">V</span><span class="p">));</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">CO</span><span class="p">,</span> <span class="s">&#39;quiver&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;quiver_density&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="c">...</span>
        <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Electric potential in Volt (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">drawnow</span><span class="p">;</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">(</span><span class="n">min</span><span class="p">(</span><span class="n">THETA</span><span class="p">),</span><span class="n">max</span><span class="p">(</span><span class="n">THETA</span><span class="p">));</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Temperature in °C (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
<tr class="row-even"><td><strong>Matlab</strong></td>
<td><div class="first last highlight-matlab"><div class="highlight"><pre><span class="n">U</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">);</span>
<span class="n">V</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;V&#39;</span><span class="p">);</span>
<span class="n">THETA</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;variable&#39;</span><span class="p">,</span> <span class="s">&#39;theta&#39;</span><span class="p">);</span>
<span class="n">VM</span> <span class="p">=</span> <span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;compute_isotropic_linearized_Von_Mises_or_Tresca&#39;</span><span class="p">,</span> <span class="s">&#39;u&#39;</span><span class="p">,</span> <span class="s">&#39;clambdastar&#39;</span><span class="p">,</span> <span class="s">&#39;cmu&#39;</span><span class="p">,</span> <span class="n">mfvm</span><span class="p">);</span>
<span class="n">CO</span> <span class="p">=</span> <span class="nb">reshape</span><span class="p">(</span><span class="n">gf_model_get</span><span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="s">&#39;interpolation&#39;</span><span class="p">,</span> <span class="p">[</span><span class="s">&#39;-&#39;</span> <span class="n">sigmaeps</span> <span class="s">&#39;*Grad_V&#39;</span><span class="p">],</span> <span class="n">mfvm</span><span class="p">),</span> <span class="p">[</span><span class="mi">2</span> <span class="n">gf_mesh_fem_get</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="s">&#39;nbdof&#39;</span><span class="p">)]);</span>

<span class="n">figure</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Von Mises stress in N/cm^2 (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">on</span><span class="p">;</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">V</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mfvm</span><span class="p">,</span> <span class="n">CO</span><span class="p">,</span> <span class="s">&#39;quiver&#39;</span><span class="p">,</span> <span class="s">&#39;on&#39;</span><span class="p">,</span> <span class="s">&#39;quiver_density&#39;</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="c">...</span>
        <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Electric potential in Volt (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
<span class="n">hold</span> <span class="n">off</span><span class="p">;</span>
<span class="n">subplot</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">);</span>
<span class="n">gf_plot</span><span class="p">(</span><span class="n">mft</span><span class="p">,</span> <span class="n">THETA</span><span class="p">,</span> <span class="s">&#39;mesh&#39;</span><span class="p">,</span> <span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformed_mesh&#39;</span><span class="p">,</span><span class="s">&#39;off&#39;</span><span class="p">,</span> <span class="s">&#39;deformation&#39;</span><span class="p">,</span> <span class="n">U</span><span class="p">,</span> <span class="s">&#39;deformation_mf&#39;</span><span class="p">,</span> <span class="n">mfu</span><span class="p">,</span> <span class="s">&#39;deformation_scale&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="s">&#39;refine&#39;</span><span class="p">,</span> <span class="mi">8</span><span class="p">);</span>
<span class="n">colorbar</span><span class="p">;</span>
<span class="n">title</span><span class="p">(</span><span class="s">&#39;Temperature in ?C (on the deformed configuration, scale factor x100)&#39;</span><span class="p">);</span>
</pre></div>
</div>
</td>
</tr>
</tbody>
</table>
<div class="figure align-center" id="tut-fig-solthermo">
<a class="reference internal image-reference" href="../images/solution_thermo.png"><img alt="../images/solution_thermo.png" src="../images/solution_thermo.png" style="width: 774.0px; height: 796.0px;" /></a>
<p class="caption">ソリューションのプロット。</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="../index.html">
    <img class="logo" src="../static/logo_getfem_small.png" alt="Logo"/>
  </a></p>
  <h3><a href="../contents.html">目次</a></h3>
  <ul>
<li><a class="reference internal" href="#">熱弾性と電気的結合の例 (単純な非線形結合問題、モデルオブジェクト、汎用アセンブリ、解析と視覚化)</a><ul>
<li><a class="reference internal" href="#the-problem-setting">問題の設定</a><ul>
<li><a class="reference internal" href="#thermal-problem">熱問題</a></li>
<li><a class="reference internal" href="#electric-potential-problem">電気電位問題</a></li>
<li><a class="reference internal" href="#deformation-problem">変形問題</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-weak-formulation">弱い定式化</a></li>
<li><a class="reference internal" href="#implementation-in-c-and-with-the-interface">C++ での実装とインターフェイス</a><ul>
<li><a class="reference internal" href="#initialization">初期化</a></li>
<li><a class="reference internal" href="#parameters-of-the-model">モデルのパラメータ</a></li>
<li><a class="reference internal" href="#mesh-generation">メッシュ生成</a></li>
<li><a class="reference internal" href="#boundary-selection">境界の選択</a></li>
<li><a class="reference internal" href="#mesh-draw">メッシュドロー</a></li>
<li><a class="reference internal" href="#definition-of-finite-element-methods-and-integration-method">有限要素法の定義と積分法</a></li>
<li><a class="reference internal" href="#model-definition">モデル定義</a></li>
<li><a class="reference internal" href="#membrane-elastic-deformation-problem">膜弾性変形問題</a></li>
<li><a class="reference internal" href="#id1">電気電位問題</a></li>
<li><a class="reference internal" href="#id2">熱問題</a></li>
<li><a class="reference internal" href="#model-solve">モデルの解決</a></li>
<li><a class="reference internal" href="#model-solve-with-two-steps">2つのステップでモデルを解く</a></li>
<li><a class="reference internal" href="#export-visualization-of-the-solution">ソリューションのエクスポート/視覚化</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>前のトピックへ</h4>
  <p class="topless"><a href="basic_usage.html"
                        title="前の章へ">Basic Usage of <em>GetFEM++</em></a></p>
  <h4>次のトピックへ</h4>
  <p class="topless"><a href="wheel.html"
                        title="次の章へ">接触中のホイールの例 (2 つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)</a></p>            <h3>Download</h3>
            <p><a href="../download.html">Download GetFEM++ </a></p>
	    <h3>Main documentations</h3>
	    <ul>
              
	      <li><a href="../userdoc/index.html">GetFEM++ User documentation</a></li>
              <li><a href="../python/index.html">Python Interface</a></li>
	      <li><a href="../matlab/index.html">Matlab Interface</a></li>
	      <li><a href="../scilab/index.html">Scilab Interface</a></li>
	      <li><a href="../gmm/index.html"> Gmm++</a></li>
	      <li><a href="../project/index.html"> GetFEM++ project</a></li>
            </ul>

            <h3>Other resources</h3>
            <ul>
              <li><a href="../screenshots/shots.html">Screenshots</a></li>
              <li><a href="../links.html">Related links</a></li>
	      <li><a href="https://savannah.nongnu.org/projects/getfem">Hosted by Savannah </a></li>
              
              
            </ul>
<div id="searchbox" style="display: none">
  <h3>クイック検索</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="検索" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    モジュール、クラス、または関数名を入力してください
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>ナビゲーション</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="総合索引"
             >索引</a></li>
        <li class="right" >
          <a href="wheel.html" title="接触中のホイールの例 (2 つのメッシュ間のアセンブリ、変換、固定サイズ変数の使用)"
             >次へ</a> |</li>
        <li class="right" >
          <a href="basic_usage.html" title="Basic Usage of GetFEM++"
             >前へ</a> |</li>
        <li><a href="https://savannah.nongnu.org/projects/getfem" <img src="../static/icon.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li></a>
        <li><a href="../index.html">GetFEM++</a> &raquo;</li>

          <li><a href="index.html" >|gf|チュートリアル</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2004-2018 GetFEM++ project.
    </div>
  </body>
</html>
