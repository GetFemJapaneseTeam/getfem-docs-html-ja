<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Small strain plasticity &mdash; GetFEM++</title>
    
    <link rel="stylesheet" href="../_static/getfem.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '5.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  false
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="copyright" title="Copyright" href="../copyright.html" />
    <link rel="top" title="GetFEM++" href="../index.html" />
    <link rel="up" title="User Documentation" href="index.html" />
    <link rel="next" title="ALE Support for object having a large rigid body motion" href="model_ALE_rotating.html" />
    <link rel="prev" title="Finite strain Elasticity bricks" href="model_nonlinear_elasticity.html" />
    <link rel="shortcut icon" type="image/png" href="../_static/icon.png" />
 

  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="model_ALE_rotating.html" title="ALE Support for object having a large rigid body motion"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="model_nonlinear_elasticity.html" title="Finite strain Elasticity bricks"
             accesskey="P">previous</a> |</li>
        <li><a href="http://gna.org/projects/getfem" <img src="../_static/icon.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li></a>
        <li><a href="../index.html">GetFEM++</a> &raquo;</li>

          <li><a href="index.html" accesskey="U">User Documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="small-strain-plasticity">
<span id="ud-model-plasticity-small-strain"></span><span id="index-0"></span><h1>Small strain plasticity<a class="headerlink" href="#small-strain-plasticity" title="Permalink to this headline">¶</a></h1>
<p>Work in progress. Not available for the moment ...</p>
<p>A framework for the approximation of plasticity models in <em>GetFEM++</em>.</p>
<div class="section" id="theoretical-background">
<h2>Theoretical background<a class="headerlink" href="#theoretical-background" title="Permalink to this headline">¶</a></h2>
<p>We present a short introduction to small strain plasticity. We refer mainly to <a class="reference internal" href="../biblio.html#si-hu1998" id="id1">[SI-HU1998]</a> and <a class="reference internal" href="../biblio.html#so-pe-ow2008" id="id2">[SO-PE-OW2008]</a> for a more detailed presentation.</p>
<div class="section" id="additive-decomposition-of-the-small-strain-tensor">
<h3>Additive decomposition of the small strain tensor<a class="headerlink" href="#additive-decomposition-of-the-small-strain-tensor" title="Permalink to this headline">¶</a></h3>
<p>Let <img class="math" src="../_images/math/8fd717e0510c17316304b0cb0f5e54846ec9c781.png" alt="\Omega \subset \R^3" style="vertical-align: -1px"/> be the reference configuration of a deformable body and <img class="math" src="../_images/math/a141185ca8aaf736ef7517af25579492b101a749.png" alt="u : \Omega \rightarrow \R^3" style="vertical-align: -1px"/> be the displacement. Small strain plasticity is based on the additive decomposition of the small deformation tensor <img class="math" src="../_images/math/215459a4a74ab26582f319599b607a611fa8f38f.png" alt="\varepsilon(u) = \Frac{\nabla u + \nabla u^T}{2}" style="vertical-align: -13px"/> in</p>
<div class="math">
<p><img src="../_images/math/7f83b39b257ec60ec191ecac7aba7fc848638085.png" alt="\varepsilon(u) = \varepsilon^e + \varepsilon^p"/></p>
</div><p>where <img class="math" src="../_images/math/7feb9c82e383570324066bbf76b4713b7162310c.png" alt="\varepsilon^e" style="vertical-align: 0px"/> is the elastic part of the deformation and <img class="math" src="../_images/math/66aff5a6578ebb94bbef84468ad78a49f00e7bc2.png" alt="\varepsilon^p" style="vertical-align: 0px"/> the plastic one.</p>
</div>
<div class="section" id="internal-variables-free-energy-potential-and-elastic-law">
<h3>Internal variables, free energy potential and elastic law<a class="headerlink" href="#internal-variables-free-energy-potential-and-elastic-law" title="Permalink to this headline">¶</a></h3>
<p>We consider</p>
<div class="math">
<p><img src="../_images/math/3e540f8c0945bc6748a14890d26535809d67b111.png" alt="\alpha : \Omega \rightarrow \R^{d_{\alpha}},"/></p>
</div><p>a vector field of <img class="math" src="../_images/math/6e39f583240b4464fc4012d8c93ce633fcc8f18e.png" alt="d_{\alpha}" style="vertical-align: -3px"/> strain type internal variables (<img class="math" src="../_images/math/ee8275d8ea63b3807d35be1e5a9cabeba25f4caf.png" alt="d_{\alpha} = 0" style="vertical-align: -3px"/> if no internal variables are considered). We consider also a free energy potential</p>
<div class="math">
<p><img src="../_images/math/0f01897c8a60d81c2f5318725c422bcadd122876.png" alt="\psi(\varepsilon^e, \alpha),"/></p>
</div><p>such that the stress type variables are determined by</p>
<div class="math">
<p><img src="../_images/math/97c5327dac97b7e4835de860c768caeb22ba9b4d.png" alt="\sigma = \Frac{\partial \psi}{\partial \varepsilon^e}(\varepsilon^e, \alpha), ~~~~ A =  \Frac{\partial \psi}{\partial \alpha}(\varepsilon^e, \alpha),"/></p>
</div><p>where <img class="math" src="../_images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma" style="vertical-align: 0px"/> is the Cauchy stress tensor and <img class="math" src="../_images/math/019e9892786e493964e145e7c5cf7b700314e53b.png" alt="A" style="vertical-align: 0px"/> the stress type internal variables. The plastic dissipation being given by</p>
<div class="math">
<p><img src="../_images/math/ab5513e0d67007d7c41c8d590c020d93c528f7d4.png" alt="\sigma:\dot{\varepsilon}^p - A.\dot{\alpha} \ge 0."/></p>
</div><p>In the standard cases, <img class="math" src="../_images/math/45825c7042e3fc69a58430ff7ea94a10a35e9252.png" alt="\psi(\varepsilon^e, \alpha)" style="vertical-align: -4px"/> is decomposed into</p>
<div class="math">
<p><img src="../_images/math/57bb12bf5e54ccf2a5c2a7fa7eb7ce3a7bc3f409.png" alt="\psi(\varepsilon^e, \alpha) = \psi^e(\varepsilon^e) + \psi^p(\alpha)."/></p>
</div><p>In the case of linearized elasticity, one has <img class="math" src="../_images/math/d6ce0cd0c16cee79ac3cad972a3bbbfabc31d99d.png" alt="\psi^e(\varepsilon^e) = \frac{1}{2} ({\cal A}\varepsilon^e) :\varepsilon^e" style="vertical-align: -6px"/> for <img class="math" src="../_images/math/0d1e7b080f04403f9c9687b8bfa0c61ac04e3dc3.png" alt="{\cal A}" style="vertical-align: -1px"/> the fourth order elasticity tensor en more precisely <img class="math" src="../_images/math/0289b2b4d04688fdc5de9e2b32a0de62758adfa4.png" alt="\psi^e(\varepsilon^e) = \mu \mbox{dev}(\varepsilon^e) : \mbox{dev}(\varepsilon^e) + \frac{1}{2} K (\mbox{tr}(\varepsilon^e))^2" style="vertical-align: -6px"/> for isotropic linearized elasticity for <img class="math" src="../_images/math/6d62c39c5398a4bd9aa68f1f3f52c2f332a80f17.png" alt="\mu, K = \lambda + 2\mu/3" style="vertical-align: -5px"/> the shear and bulk modulus, respectively.</p>
</div>
<div class="section" id="plastic-potential-yield-function-and-plastic-flow-rule">
<h3>Plastic potential, yield function and plastic flow rule<a class="headerlink" href="#plastic-potential-yield-function-and-plastic-flow-rule" title="Permalink to this headline">¶</a></h3>
<p>The plastic deformation is supposed to occurs when the stress attains a critical value. This is determinated by a yield function <img class="math" src="../_images/math/d21cbde12ddc9c81016c3ed877d7dcb9a8cc91db.png" alt="f(\sigma, A)" style="vertical-align: -4px"/> and the condition</p>
<div class="math">
<p><img src="../_images/math/45117f3bf6100431583be956b533cfbbfe859db4.png" alt="f(\sigma, A) \le 0."/></p>
</div><p>The surface <img class="math" src="../_images/math/16eba01a89ae3351675733709215eae3a2dd0298.png" alt="f(\sigma, A) = 0" style="vertical-align: -4px"/> being the yield surface where the plastic deformation may occur.</p>
<p>Let us consider also the plastic potential <img class="math" src="../_images/math/d189f9acc51d583be8451f71b506e97b19ad312e.png" alt="\Psi(\sigma, A)" style="vertical-align: -4px"/>, (convex with respect to both its two variables) which determine the plastic flow direction in the sense that the flow rule reads as</p>
<div class="math">
<p><img src="../_images/math/44a049f9715f41eef5c18ee654e31d6267ea7d51.png" alt="\dot{\varepsilon}^p = \dot{\gamma} \Frac{\partial \Psi}{\partial \sigma}(\sigma, A), ~~~~~~ \dot{\alpha} = \dot{\gamma} \Frac{\partial \Psi}{\partial A}(\sigma, A),"/></p>
</div><p>with the additional complementary condition</p>
<div class="math">
<p><img src="../_images/math/32b5cb5f5705a0e9a7221c2136674fee50a7088d.png" alt="f(\sigma, A) \le 0, ~~~ \dot{\gamma} \ge 0, ~~~ f(\sigma, A) \dot{\gamma} = 0."/></p>
</div><p>The variable <img class="math" src="../_images/math/b2a29288693f2267c2ef1865e354ac6e1ff2a48c.png" alt="\dot{\gamma}" style="vertical-align: -4px"/> is called the plastic multiplier. Note that when <img class="math" src="../_images/math/1a2f83df5ef59353b8cd6273810b91a1bde20df4.png" alt="\psi(\varepsilon^e, \alpha), f(\sigma, A) \mbox{ or } \Psi(\sigma, A)" style="vertical-align: -4px"/> are not differentiable, subdifferentials have to be used. Associated plasticity corresponds to the choice <img class="math" src="../_images/math/3fbb38b4901df20ec9a4f9ad6fc7a98198aefe5d.png" alt="\Psi(\sigma, A) = f(\sigma, A)" style="vertical-align: -4px"/>.</p>
</div>
<div class="section" id="initial-boundary-value-problem">
<h3>Initial boundary value problem<a class="headerlink" href="#initial-boundary-value-problem" title="Permalink to this headline">¶</a></h3>
<p>The weak formulation of a dynamic elastoplastic problem can be written as follows for an arbitrary cinematically admissible test function <img class="math" src="../_images/math/a9f23bf124b6b2b2a993eb313c72e678664ac74a.png" alt="v" style="vertical-align: 0px"/>:</p>
<div class="math">
<p><img src="../_images/math/55bd83d27c369ae6b8a541b224d7a350ab061dec.png" alt="\left| \begin{array}{l}
\ds \int_{\Omega} \rho \ddot{u}\cdot v + \sigma : \nabla v dx =  \int_{\Omega} f\dot v dx + \int_{\Gamma_N} g\dot v dx, \\
u(0,x) = u_0(x), ~~~\dot{u}(0) = v_0(x), \\
\varepsilon^p(0,x) = \varepsilon^p_0, ~~~ \alpha(0,x) = \alpha_0,
\end{array} \right."/></p>
</div><p>for <img class="math" src="../_images/math/51eea6e2dfd7a30e0d369c1512d855bd0f34b0a8.png" alt="u_0, v_0, \varepsilon^p_0, \alpha_0" style="vertical-align: -4px"/> the initial values and <img class="math" src="../_images/math/311cabda3a9b09f0dde217303ca9d1cd9201dcf6.png" alt="g" style="vertical-align: -4px"/> the force prescribed on the part of the boundary <img class="math" src="../_images/math/0b983602095bda2a85dd1b0c177f154eaffbecbd.png" alt="\Gamma_N" style="vertical-align: -3px"/>.</p>
<p>Note that plasticity models are often applied on quasitistic problem which corresponds to neglect the term <img class="math" src="../_images/math/976853811932b1e8372fc94482174cb463b4d336.png" alt="\rho \ddot{u}" style="vertical-align: -4px"/>.</p>
<p>Given a time step <img class="math" src="../_images/math/a1ffc0a012620941fe660cedabff822ce7162eca.png" alt="\Delta t" style="vertical-align: 0px"/> we will denote in the sequel <img class="math" src="../_images/math/420915488802965edb68ef971f8bf8100881755f.png" alt="u_n, \varepsilon^p_n  \mbox{ and } \alpha_n" style="vertical-align: -5px"/> the approximation at time <img class="math" src="../_images/math/f5069254eaa277c35d42ba6b8022dd855e89fd6b.png" alt="n\Delta t" style="vertical-align: 0px"/> of <img class="math" src="../_images/math/22b3d2fdae5341fd8e191256c8286a4811ed2738.png" alt="u(t), \varepsilon^p_n \mbox{ and } \alpha(t)" style="vertical-align: -5px"/> respectively. This approximation is given by a chose time integration scheme (for instance one of the proposed schemes in <a class="reference internal" href="model_time_integration.html#ud-model-time-integration"><em>The model tools for the integration of transient problems</em></a>) which can be different than the time integration scheme used for the integration of the flow rule (see below).</p>
</div>
</div>
<div class="section" id="flow-rule-integration">
<h2>Flow rule integration<a class="headerlink" href="#flow-rule-integration" title="Permalink to this headline">¶</a></h2>
<p>The plastic flow rule have to be integrated with its own time integration scheme.  Among standards schemes, backward Euler scheme, <img class="math" src="../_images/math/52e8ed7a3ba22130ad3984eb2cd413406475a689.png" alt="\theta" style="vertical-align: 0px"/>-scheme and generalized mid-point scheme are the most commonly used in that context. We make here the choice of the generalized mid-point scheme.</p>
<p>Let <img class="math" src="../_images/math/2527fa77391babb15b45bb43138b36681fc40fc7.png" alt="u_{n+1}" style="vertical-align: -4px"/> be the displacement at the considered time step and  <img class="math" src="../_images/math/3ea0fb113e45cc0d113022534aa991a28dd7b1d5.png" alt="u_{n}" style="vertical-align: -3px"/> at the previous one. For a quantity <img class="math" src="../_images/math/ff5fb3d775862e2123b007eb4373ff6cc1a34d4e.png" alt="B" style="vertical-align: 0px"/> we denote <img class="math" src="../_images/math/4ce97bfb6ccbe512671604226e0254e11b8d4adc.png" alt="B_{n+\theta} = \theta B_{n+1} + (1-\theta)B_n" style="vertical-align: -4px"/> the convex combination of the quantity at iterations <img class="math" src="../_images/math/174fadd07fd54c9afe288e96558c92e0c1da733a.png" alt="n" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/0e3efd9b14723a92c2ae891fe27780d5f8e2b215.png" alt="n+1" style="vertical-align: -1px"/>.</p>
<p>The mid-point scheme for the integration of the plastic flow rules reads as</p>
<div class="math">
<p><img src="../_images/math/6cb6cfd5537a1b3d285bfda9f2429ffb359c6452.png" alt="\varepsilon^p_{n+1} - \varepsilon^p_{n} = \Delta \gamma \Frac{\Psi}{\partial \sigma}(\sigma_{n+\theta}, A_{n+\theta}),"/></p>
</div><div class="math">
<p><img src="../_images/math/c640f151d5cebdcb93ed05b5c813d25264933f13.png" alt="\alpha_{n+1} - \alpha_n = \Delta \gamma \Frac{\Psi}{\partial A}(\sigma_{n+\theta}, A_{n+\theta}),"/></p>
</div><p>with the complementary condition</p>
<div class="math">
<p><img src="../_images/math/d9d57b5998bb19ef62571b43aeb459b305160ff8.png" alt="f(\sigma_{n+\theta}, A_{n+\theta}) \le 0, ~~~ \Delta\gamma \ge 0, ~~~ f(\sigma_{n+\theta}, A_{n+\theta}) \Delta \gamma = 0."/></p>
</div><p>where <img class="math" src="../_images/math/8654725100f96a90d0b46a11028e09bc45bd4f67.png" alt="0 &lt; \theta \le 1" style="vertical-align: -3px"/> is the parameter of the mid-point scheme. We exclude <img class="math" src="../_images/math/8656595bf44ec840dac700925abe3bcbccab0b46.png" alt="\theta = 0" style="vertical-align: 0px"/> because we will not consider explicit integration of plasticity. Let us recall that <img class="math" src="../_images/math/72ad431cc263034d8221a41fe80cc1bcf0164959.png" alt="\theta = 1" style="vertical-align: -1px"/> corresponds to the backward Euler scheme and <img class="math" src="../_images/math/4260c84580aacab7b48e8f69168d2b50cbbe5a05.png" alt="\theta = 1/2" style="vertical-align: -5px"/> to the mid-point scheme which is a second order consistent scheme.</p>
<p>A solution would be to solve the whole problem with all the unknows, that is <img class="math" src="../_images/math/23fee4661e450b8268fb5cb65c051b5751e6c140.png" alt="u_{n+1}, \Delta \gamma, \varepsilon^p_{n+1} \mbox{ and } A_{n+1}" style="vertical-align: -5px"/>. This is of course possible but would be a rather expensive strategy because of the resulting high number of degrees of freedom. A classical strategy (the return mapping one for instance, see <a class="reference internal" href="../biblio.html#so-pe-ow2008" id="id3">[SO-PE-OW2008]</a> or the closes point projection one) consist in integrating locally the plastic flow on each Gauss point of the considered integration method separately, or more precisely to consider on each Gauss point the maps</p>
<div class="math">
<p><img src="../_images/math/ab32822903a224e290c5597894726ff20c8900c7.png" alt="{\mathscr E}^p : (u_{n+\theta}, \varepsilon^p_{n}, \alpha_n) \mapsto \varepsilon^p_{n+\theta}

{\mathscr A} : (u_{n+\theta}, \varepsilon^p_{n}, \alpha_n) \mapsto \alpha_{n+\theta}"/></p>
</div><p>which results from the local flow rule integration  (the pair <img class="math" src="../_images/math/3611ed96127255999ff38ba21fa4130e1ea5bd13.png" alt="(\varepsilon^p_{n+\theta}, \alpha_{n+\theta}) = ({\mathscr E}^p(u_{n+\theta},  \varepsilon^p_{n}, \alpha_n), {\mathscr A}(u_{n+\theta}, \varepsilon^p_{n}, \alpha_n))" style="vertical-align: -6px"/> is the solution to equations <a href="#equation-flowrule1">(1)</a>, <a href="#equation-flowrule2">(2)</a> and  <a href="#equation-flowrule3">(3)</a>). Both these maps and their tangent moduli (usually called consistent tangent moduli) are then used in the global solve of the problem with a Newton method and for <img class="math" src="../_images/math/2527fa77391babb15b45bb43138b36681fc40fc7.png" alt="u_{n+1}" style="vertical-align: -4px"/> the unique remaining variable. The advantage of the return mapping strategy is that the unique variable of the global solve is the displacement <img class="math" src="../_images/math/2527fa77391babb15b45bb43138b36681fc40fc7.png" alt="u_{n+1}" style="vertical-align: -4px"/>. A nonlinear solve on each Gauss point is often necessary which is usualy performed with a local Newton method.</p>
<p>In <em>GetFEM++</em> we propose both the return mapping trategy and also an alternative strategy developped below which is mainly inspired from  <a class="reference internal" href="../biblio.html#po-ni2016" id="id4">[PO-NI2016]</a>,  <a class="reference internal" href="../biblio.html#se-po-wo2015" id="id5">[SE-PO-WO2015]</a> and <a class="reference internal" href="../biblio.html#ha-wo2009" id="id6">[HA-WO2009]</a> and allow more simple tangent moduli. It consists in keeping (a multiple of) <img class="math" src="../_images/math/aaab8af01f987615bcfddbe8aacae45055d027e7.png" alt="\Delta \gamma" style="vertical-align: -4px"/> as an additional unknown with respect to <img class="math" src="../_images/math/2527fa77391babb15b45bb43138b36681fc40fc7.png" alt="u_{n+1}" style="vertical-align: -4px"/>. As we will see, this will allow a more generic treatment of the yield functions, the price for the simplicity being this additional unknown scalar field.</p>
<p>First, we consider an additional (and optional) given function <img class="math" src="../_images/math/96702600c93f946ff46ddb439ee408d00208d669.png" alt="\alpha(\sigma_{n+\theta}, A_{n+\theta}) &gt; 0" style="vertical-align: -4px"/> whose interest will appear later on (it will allow simple local inverses) and the new unknown scalar field</p>
<div class="math">
<p><img src="../_images/math/fc5ea7d7b56ec6584f744695651c949ea7e60fa2.png" alt="\Delta \xi = \Frac{\Delta \gamma}{\alpha(\sigma_{n+\theta}, A_{n+\theta})} ,"/></p>
</div><p>so that our two main unknows are now <img class="math" src="../_images/math/ef9400295992cffca5bde4b5ca5c140ee5678b19.png" alt="u_{n+1} \mbox{ and } \Delta \xi" style="vertical-align: -4px"/>. The plastic flow rule integration may now read:</p>
<div class="math" id="equation-flowrule1">
<p><span class="eqno">(1)</span><img src="../_images/math/ff1be2b262e71e3fc7c074977462ff0b858acdbb.png" alt="\varepsilon^p_{n+\theta} - \varepsilon^p_{n} = \alpha(\sigma_{n+\theta}, A_{n+\theta}) \theta \Delta \xi \Frac{\Psi}{\partial \sigma}(\sigma_{n+\theta}, A_{n+\theta})."/></p>
</div><div class="math" id="equation-flowrule2">
<p><span class="eqno">(2)</span><img src="../_images/math/ca4a0185d1cf2e1e20b52b4061e5ffcab31f0e87.png" alt="\alpha_{n+\theta} - \alpha_n = \alpha(\sigma_{n+\theta}, A_{n+\theta}) \theta \Delta \xi \Frac{\Psi}{\partial A}(\sigma_{n+\theta}, A_{n+\theta}),"/></p>
</div><div class="math" id="equation-flowrule3">
<p><span class="eqno">(3)</span><img src="../_images/math/ba2baaebab538852553c726359fcd10b396e35c4.png" alt="f(\sigma_{n+\theta}, A_{n+\theta}) \le 0, ~~~ \Delta\xi \ge 0, ~~~ f(\sigma_{n+\theta}, A_{n+\theta}) \Delta \xi = 0."/></p>
</div><p>For <img class="math" src="../_images/math/ef9400295992cffca5bde4b5ca5c140ee5678b19.png" alt="u_{n+1} \mbox{ and } \Delta \xi" style="vertical-align: -4px"/> be given, we define the two maps</p>
<div class="math">
<p><img src="../_images/math/88e17004caa0637b58fab10e3aabac58b4ff4012.png" alt="\tilde{\mathscr E}^p : (u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}, \alpha_n) \mapsto \varepsilon^p_{n+\theta}

\tilde{\mathscr A} : (u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}, \alpha_n) \mapsto \alpha_{n+\theta}"/></p>
</div><p>where the pair <img class="math" src="../_images/math/fa3885aaa9347b9c247a124cbc1f7f9005b0fd0d.png" alt="(\varepsilon^p_{n+\theta}, \alpha_{n+\theta}) = (\tilde{\mathscr E}^p(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}, \alpha_n), \tilde{\mathscr A}(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}, \alpha_n))" style="vertical-align: -6px"/> is the solution to equations <a href="#equation-flowrule1">(1)</a>, <a href="#equation-flowrule2">(2)</a> (without the consideration of  <a href="#equation-flowrule3">(3)</a>). We will see later, that, at least for simple isotropic plastic flow rules, these maps have a simple expression, even sometimes a linear one with respect to <img class="math" src="../_images/math/81d775f9e0543734eef063a8a03d1741988a34aa.png" alt="u_{n+\theta}" style="vertical-align: -4px"/>.</p>
<p>Still <img class="math" src="../_images/math/ef9400295992cffca5bde4b5ca5c140ee5678b19.png" alt="u_{n+1} \mbox{ and } \Delta \xi" style="vertical-align: -4px"/> be given the stress <img class="math" src="../_images/math/68ac28a5bbe01bf309a82fa48996110e79f30df4.png" alt="\sigma_{n+1}" style="vertical-align: -4px"/> reads</p>
<div class="math">
<p><img src="../_images/math/c415295cb5eec1848b9ae0c4c363fef77f716d5b.png" alt="\sigma_{n+1} = \Frac{\partial \psi^e}{\partial \varepsilon^e}(\varepsilon(u_{n+1}) -\varepsilon^p_{n+1})."/></p>
</div><div class="math">
<p><img src="../_images/math/8f61203a4a1bcf642064d69289683f589a438122.png" alt="A_{n+1} = \Frac{\partial \psi^p}{\partial \alpha}(\alpha_{n+1})."/></p>
</div><p>The complementarity equation <a href="#equation-flowrule3">(3)</a> is then prescribed with the use of a well chosen complementarity function, as in <a class="reference internal" href="../biblio.html#ha-wo2009" id="id7">[HA-WO2009]</a> for <img class="math" src="../_images/math/22ff7db3e755a8164f2344e0d3d84ea3a0fe93b3.png" alt="r &gt; 0" style="vertical-align: 0px"/> such as:</p>
<div class="math">
<p><img src="../_images/math/4db4128b509e64b96f5c3494a9b76fb518d4697b.png" alt="\ds \int_{\Omega} (\Delta \xi - (\Delta \xi + r f(\sigma_{n+\theta}, A_{n+\theta}))_+) \lambda dx = 0,   \forall \lambda"/></p>
</div><p>or</p>
<div class="math">
<p><img src="../_images/math/32f494ddfc73af4397aa19e2040c09902f16c8ba.png" alt="\ds \int_{\Omega} (f(\sigma_{n+\theta} + (-f(\sigma_{n+\theta}, A_{n+\theta}) - \Delta \xi/r)_+ , A_{n+\theta}) ) \lambda dx = 0,   \forall \lambda"/></p>
</div><p>pb : need of <img class="math" src="../_images/math/64515510997be6fbb463540c3227e672d2def375.png" alt="A_{n+\theta}" style="vertical-align: -4px"/></p>
<div class="section" id="plane-strain-approximation">
<h3>Plane strain approximation<a class="headerlink" href="#plane-strain-approximation" title="Permalink to this headline">¶</a></h3>
<p>A plane strain approximation is a 2D problem which corresponds to the deformation of a long cylindrical object where the strain in the length direction (assumed to be along the <img class="math" src="../_images/math/b13f21416d84e13708696f34dea81026cda583c9.png" alt="z" style="vertical-align: 0px"/> axis) is considered small compared to the ones in the other directions and is neglected. It result in a plane strain tensor of the form</p>
<div class="math">
<p><img src="../_images/math/3c400c95fa9981b85c6408f383cf4851dd42acdd.png" alt="\varepsilon(u) = \left(\hspace{-0.5em}\begin{array}{ccc} \varepsilon_{1,1} &amp; \varepsilon_{1,2} &amp; 0 \\ \varepsilon_{1,2} &amp; \varepsilon_{2,2} &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{array}\hspace{-0.5em}\right)."/></p>
</div><p>We denote</p>
<div class="math">
<p><img src="../_images/math/52d83be4c88ab1f3b00fb6b3e4be0c360c064eec.png" alt="\bar{\varepsilon}(u) =  \left(\hspace{-0.5em}\begin{array}{cc} \varepsilon_{1,1} &amp; \varepsilon_{1,2} \\ \varepsilon_{1,2} &amp; \varepsilon_{2,2} \end{array}\hspace{-0.5em}\right)"/></p>
</div><p>the non neglected components of the strain tensor.
In the decomposition of plastic and elastic part of the strain tensor, we assume</p>
<div class="math">
<p><img src="../_images/math/956355f26424de1de1b32e39b133f63fe8c93590.png" alt="\varepsilon^p_{1,3} = \varepsilon^p_{2,3} = \varepsilon^e_{1,3} = \varepsilon^e_{2,3} = 0"/></p>
</div><p>and</p>
<div class="math">
<p><img src="../_images/math/cf736d7e5c209e68af7696d5246312f6cb46ba0a.png" alt="\varepsilon^e_{3,3} + \varepsilon^p_{3,3} = \varepsilon_{3,3} = 0."/></p>
</div><p>The adaptation to the plane strain approximation to plastic model is most of the time an  easy task. An isotropic linearized elastic response reads</p>
<div class="math">
<p><img src="../_images/math/e60b274599f4ddad5d700e731a7ba080625b5b8f.png" alt="\sigma = \lambda \mbox{tr}(\varepsilon(u)) I + 2\mu(\varepsilon(u) - \varepsilon^p),"/></p>
</div><p>and thus</p>
<div class="math">
<p><img src="../_images/math/e07c91024f1efb456e23988314ee72acf1976448.png" alt="\bar{\sigma} = \lambda \mbox{tr}(\bar{\varepsilon}(u)) \bar{I} + 2\mu(\bar{\varepsilon}(u) -\bar{\varepsilon}^p),"/></p>
</div><p>The nonzero <img class="math" src="../_images/math/383a487d1bc7ebf768b688dd29eba48fd714e925.png" alt="\sigma_{3,3}" style="vertical-align: -6px"/> component of the stress tensor is given by</p>
<div class="math">
<p><img src="../_images/math/a4410a6bed5ee3a4b24c5d78cf87eabcc746a6cc.png" alt="\sigma_{3,3} = \lambda \mbox{tr}(\bar{\varepsilon}(u)) - 2\mu \varepsilon^p_{3,3}"/></p>
</div><p>Note that in the common case where isochoric plastic strain is assumed, one has</p>
<div class="math">
<p><img src="../_images/math/7cefc951b0b425d9aaa1b8d11fd0275bf3bd29ae.png" alt="\mbox{ tr}(\varepsilon^p) = 0 ~~~~ \Rightarrow  ~~~ \varepsilon^p_{3,3} = - (\varepsilon^p_{1,1} + \varepsilon^p_{2,2})."/></p>
</div></div>
<div class="section" id="plane-stress-approximation">
<h3>Plane stress approximation<a class="headerlink" href="#plane-stress-approximation" title="Permalink to this headline">¶</a></h3>
<p>The plane stress approximation describe generally the 2D membrane deformation of a thin plate. It consist in prescribing the stress tensor to have only in-plane nonzero components, i.e.</p>
<div class="math">
<p><img src="../_images/math/dac6708ca2d0f549a4770b5c15a2f855922e20c0.png" alt="\sigma = \left(\hspace{-0.5em}\begin{array}{ccc} \sigma_{1,1} &amp; \sigma_{1,2} &amp; 0 \\ \sigma_{1,2} &amp; \sigma_{2,2} &amp; 0 \\ 0 &amp; 0 &amp; 0 \end{array}\hspace{-0.5em}\right)."/></p>
</div><p>We will still denote</p>
<div class="math">
<p><img src="../_images/math/4d3fbe05f250c74775afca142acfb12622d8a3a1.png" alt="\bar{\sigma} =  \left(\hspace{-0.5em}\begin{array}{cc} \sigma_{1,1} &amp; \sigma_{1,2} \\ \sigma_{1,2} &amp; \sigma_{2,2} \end{array}\hspace{-0.5em}\right)"/></p>
</div><p>the in-plane components of the stress tensor. For elastoplasticity, it consists generally to apply the 2D plastic flow rule, prescribing the out-plane components of the stress tensor to be zero with the additionnal variables <img class="math" src="../_images/math/adbcae655c0273b10529aae0dcc5520df66908b9.png" alt="\varepsilon^e_{1,3}" style="vertical-align: -8px"/>, <img class="math" src="../_images/math/db2c003a051b25584fb3f2129a675e3d4277a329.png" alt="\varepsilon^e_{2,3}" style="vertical-align: -8px"/>, <img class="math" src="../_images/math/93bc81808a177f858429feac0324269583e32ac6.png" alt="\varepsilon^e_{3,3}" style="vertical-align: -8px"/> being unknown (see for instance <a class="reference internal" href="../biblio.html#so-pe-ow2008" id="id8">[SO-PE-OW2008]</a>).</p>
<p>For an isotropic linearized elastic response, one has <img class="math" src="../_images/math/19af56abcec2a24582f87455d68817d6360b33f2.png" alt="\sigma = \lambda \mbox{tr}(\varepsilon^e) + 2\mu\varepsilon^e" style="vertical-align: -4px"/> such that</p>
<div class="math">
<p><img src="../_images/math/9d90ca8a71e9c173359aecddc5af498673ea22c1.png" alt="\varepsilon^e = \left(\hspace{-0.5em}\begin{array}{ccc} \varepsilon^e_{1,1} &amp; \varepsilon^e_{1,2} &amp; 0 \\ \varepsilon^e_{1,2} &amp; \varepsilon^e_{2,2} &amp; 0 \\ 0 &amp; 0 &amp; \varepsilon^e_{3,3} \end{array}\hspace{-0.5em}\right)."/></p>
</div><p>with</p>
<div class="math">
<p><img src="../_images/math/6bf5478a829bba31982937269d02ad328d2c0a99.png" alt="\varepsilon^e_{3,3} = -\Frac{\lambda}{\lambda+2\mu}(\varepsilon^e_{1,1} + \varepsilon^e_{2,2})"/></p>
</div><p>so that</p>
<div class="math" id="equation-plane_stress_iso">
<p><span class="eqno">(4)</span><img src="../_images/math/1fac4de40c1c4783a15128da28b47ed32c1beff6.png" alt="\bar{\sigma} = \lambda^* \mbox{tr}(\bar{\varepsilon}^e) + 2\mu\bar{\varepsilon}^e ~~~\mbox{ with } \lambda^* = \Frac{2\mu\lambda}{\lambda+2\mu}"/></p>
</div><p>Moreover</p>
<div class="math">
<p><img src="../_images/math/14e8581f6e1d74b6c25bdb7a3df9e1c3988ca9b2.png" alt="\|\mbox{Dev}(\sigma)\| = \left(\|\bar{\sigma}\|^2 - \Frac{1}{3}(\mbox{tr}(\bar{\sigma}))^2\right)^{1/2}."/></p>
</div><p>Note that in the case where isochoric plastic strain is assumed, one still has</p>
<div class="math">
<p><img src="../_images/math/7cefc951b0b425d9aaa1b8d11fd0275bf3bd29ae.png" alt="\mbox{ tr}(\varepsilon^p) = 0 ~~~~ \Rightarrow  ~~~ \varepsilon^p_{3,3} = - (\varepsilon^p_{1,1} + \varepsilon^p_{2,2})."/></p>
</div></div>
</div>
<div class="section" id="some-classical-laws">
<h2>Some classical laws<a class="headerlink" href="#some-classical-laws" title="Permalink to this headline">¶</a></h2>
<p>Tresca : <img class="math" src="../_images/math/df044f0b58fe425144f45a928ce2e62b158148b0.png" alt="\rho(\sigma) \le \sigma_y" style="vertical-align: -6px"/> where <img class="math" src="../_images/math/6bb53190d5070c4e4026d1b2c0a2abcb8207a8bd.png" alt="\rho(\sigma)" style="vertical-align: -4px"/> spectral radius of the Cauchy stress tensor and <img class="math" src="../_images/math/2409322e14bd3cbf9b678cfa12452196779d78da.png" alt="\sigma_y" style="vertical-align: -6px"/> the uniaxial yield stress (which may depend on some hardening internal variables.</p>
<p>Von Mises :  <img class="math" src="../_images/math/235617fbf0ed75092e989859d3ad728741c1f809.png" alt="\|\mbox{Dev}(\sigma)\| \le \sqrt{\frac{2}{3}}\sigma_y" style="vertical-align: -12px"/> where
<img class="math" src="../_images/math/5f18e7fdd97d1df45ba2742a736f392065db048f.png" alt="\mbox{Dev}(\sigma) = \sigma - \frac{1}{3}\mbox{tr}(\sigma)I" style="vertical-align: -6px"/> the deviatoric part of <img class="math" src="../_images/math/fa35d9fc104207e09a712110ac81612c5b279a6c.png" alt="\sigma" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/452880b553aab385b333b10fcc45bd2acb8bfef4.png" alt="\|\sigma\| = \sqrt{\sigma:\sigma}" style="vertical-align: -5px"/>.</p>
<div class="section" id="perfect-isotropic-associated-elastoplasticity-with-von-mises-criterion-prandl-reuss-model">
<h3>Perfect isotropic associated elastoplasticity with Von-Mises criterion (Prandl-Reuss model)<a class="headerlink" href="#perfect-isotropic-associated-elastoplasticity-with-von-mises-criterion-prandl-reuss-model" title="Permalink to this headline">¶</a></h3>
<p>There is no internal variables and we consider an isotropic elastic response. The flow rule reads</p>
<div class="math">
<p><img src="../_images/math/13c733b3b51ba3fc4877e87335cda5b05caf7c6b.png" alt="\dot{\varepsilon}^p = \dot{\gamma} \Frac{\mbox{Dev}(\sigma)}{\|\mbox{Dev}(\sigma)\|}"/></p>
</div><p>This corresponds to <img class="math" src="../_images/math/9867eeac23884390538e979f23cd7d5c40e341fe.png" alt="\Psi(\sigma) = f(\sigma) = \|\mbox{Dev}(\sigma)\| - \sqrt{\frac{2}{3}}\sigma_y" style="vertical-align: -12px"/>.</p>
<p>The generalized mid-point scheme for the integration of the plastic flow rule reads:</p>
<div class="math">
<p><img src="../_images/math/3bcc09174d550f2b5b55e668aed64233aee20e95.png" alt="\varepsilon^p_{n+\theta} - \varepsilon^p_{n} = \theta \alpha(\sigma_{n+\theta}, A_{n+\theta}) \Delta \xi \Frac{\mbox{Dev}(\sigma_{n+\theta})}{\|\mbox{Dev}(\sigma_{n+\theta})\|}."/></p>
</div><p>Choosing the factor <img class="math" src="../_images/math/af1aafa2483008d583c892f7d6c1277606623c68.png" alt="\alpha(\sigma_{n+\theta}) = \|\mbox{Dev}(\sigma_{n+\theta})\|" style="vertical-align: -5px"/> and still with <img class="math" src="../_images/math/a89c1314465c3554e5961fa5e42fb6e283f3b927.png" alt="\Delta \xi = \Frac{\Delta \gamma}{\alpha(\sigma_{n+\theta})}" style="vertical-align: -17px"/> this gives the equation</p>
<div class="math">
<p><img src="../_images/math/b354482e0dc3e19bea5c28c3f94fa3c697cf00cc.png" alt="\varepsilon^p_{n+\theta} - \varepsilon^p_{n} = \theta \Delta \xi \mbox{Dev}(\sigma_{n+\theta})."/></p>
</div><p>Since <img class="math" src="../_images/math/1d4cf0c6027499344cc541ad45af57e4329f6044.png" alt="\mbox{Dev}(\sigma_{n+\theta}) = 2\mu\mbox{Dev}(\varepsilon(u_{n+\theta})) - 2\mu\varepsilon^p_{n+\theta}" style="vertical-align: -6px"/> this directly gives:</p>
<div class="math">
<p><img src="../_images/math/19d64f86356d2c829e4d11cba9d2c577b5ea50e0.png" alt="\tilde{\mathscr E}^p(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}) = \Frac{1}{1+2\mu\theta\Delta \xi}(\varepsilon^p_{n} + 2\mu\theta\Delta \xi \mbox{Dev}(\varepsilon(u_{n+\theta}))),"/></p>
</div><p>which is a linear expression with respect to <img class="math" src="../_images/math/2527fa77391babb15b45bb43138b36681fc40fc7.png" alt="u_{n+1}" style="vertical-align: -4px"/> (but not with respect to <img class="math" src="../_images/math/03e939743f0a722881e5e7554ae2315bf5f4c3fd.png" alt="\Delta \xi" style="vertical-align: -4px"/>).</p>
<p><strong>Closest point projection approach (elimination of the multiplier)</strong></p>
<p>The flow rule can be written in term of differential inclusion</p>
<div class="math">
<p><img src="../_images/math/39d41c270eb87b7adcfea4ad474c8069e29c1899.png" alt="\dot{\varepsilon}^p \in  \partial I_K(\sigma),"/></p>
</div><p>where <img class="math" src="../_images/math/56b0a346809c71f401642636e7f099ac4e4306c2.png" alt="K = \left\{ \sigma : \|\mbox{Dev}(\sigma)\| \le \sqrt{\frac{2}{3}}\sigma_y\right\}" style="vertical-align: -13px"/> is the set of admissible stres tensors, <img class="math" src="../_images/math/a2d19e01b89c755ef31f29f6671d3eea6194eaa1.png" alt="I_K" style="vertical-align: -3px"/> is the indicator function of this set and <img class="math" src="../_images/math/2e5d89060a87dce9bea2d5b1bcb4584dcd699902.png" alt="\partial I_K" style="vertical-align: -3px"/> its sub-differential (normal cone to <img class="math" src="../_images/math/dfb064112b6c94470339f6571f69d07afc1c024c.png" alt="K" style="vertical-align: 0px"/>). This can be equivalently written</p>
<div class="math">
<p><img src="../_images/math/aad344f39405697aa24af462f27b3f64ec93ef68.png" alt="\sigma\in K, ~~~(\tau - \sigma):\dot{\varepsilon}^p \le 0 ~~~ \forall \tau \in K."/></p>
</div><p>or</p>
<div class="math">
<p><img src="../_images/math/6bedf8842fe8cebceca7a1c2e5af6382b251027d.png" alt="{\cal A}(\bar{\tau} - \varepsilon(u) + \varepsilon^p):\dot{\varepsilon}^p \le 0 ~~~ \forall \bar{\tau} \in {\cal A}^{-1}K,"/></p>
</div><p>where <img class="math" src="../_images/math/0d1e7b080f04403f9c9687b8bfa0c61ac04e3dc3.png" alt="{\cal A}" style="vertical-align: -1px"/> is the fourth order elasticity tensor. Now, in term of projection it can be expressed as</p>
<div class="math">
<p><img src="../_images/math/dfa73b0e23ba4d5869bdbbbe5a83c8e4c4b10414.png" alt="\varepsilon(u) - \varepsilon^p = P^{{\cal A}}_{{\cal A}^{-1}K}(\varepsilon(u) - \varepsilon^p + r\dot{\varepsilon}^p),"/></p>
</div><p>for any <img class="math" src="../_images/math/22ff7db3e755a8164f2344e0d3d84ea3a0fe93b3.png" alt="r &gt; 0" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/a44cac1347a2a6ba26630789725ff4548645d8e6.png" alt="P^{{\cal A}}_{{\cal A}^{-1}K}" style="vertical-align: -7px"/> being the orthogonal projection on <img class="math" src="../_images/math/6a1e66c16cdb7fd290a8b48acdcda2e06607d55b.png" alt="{\cal A}^{-1}K" style="vertical-align: -1px"/> with respect to the scalar product induced by <img class="math" src="../_images/math/0d1e7b080f04403f9c9687b8bfa0c61ac04e3dc3.png" alt="{\cal A}" style="vertical-align: -1px"/>.</p>
<p>The generalize mid-point scheme reads</p>
<div class="math">
<p><img src="../_images/math/2040afeb6e71218bb862d4782c641dd224be4b73.png" alt="\varepsilon(u_{n+\theta}) - \varepsilon^p_{n+\theta} = P^{{\cal A}}_{{\cal A}^{-1}K}\left(\varepsilon(u_{n+\theta}) - \varepsilon^p_{n+\theta} + \Frac{r}{\theta}(\varepsilon^p_{n+\theta}-\varepsilon^p_{n})\right)."/></p>
</div><p>With the choice <img class="math" src="../_images/math/00db9e57e20f34fa478da3ae559e2a723b69aff4.png" alt="\Frac{r}{\theta} = 1" style="vertical-align: -13px"/> this gives</p>
<div class="math">
<p><img src="../_images/math/11c88fbfc24f847765d62f32cc17381da0c958f9.png" alt="\varepsilon(u_{n+\theta}) = \varepsilon^p_{n} + (I - P^{{\cal A}}_{{\cal A}^{-1}K})(\varepsilon(u_{n+\theta})-\varepsilon^p_{n})."/></p>
</div><p>Since <img class="math" src="../_images/math/a44cac1347a2a6ba26630789725ff4548645d8e6.png" alt="P^{{\cal A}}_{{\cal A}^{-1}K}" style="vertical-align: -7px"/> can be expressed as</p>
<div class="math">
<p><img src="../_images/math/6bfa6b3c07891a45cd2df49a520bb5bff0680652.png" alt="P^{{\cal A}}_{{\cal A}^{-1}K}(\varepsilon) = \Frac{\mbox{tr}(\varepsilon)}{3}I + \min\left(\Frac{1}{2\mu}\sqrt{\frac{2}{3}}\sigma_y, \|\mbox{Dev}(\varepsilon)\|\right) \Frac{\mbox{Dev}(\varepsilon)}{\|\mbox{Dev}(\varepsilon)\|},"/></p>
</div><p>We finally find with <img class="math" src="../_images/math/79545ed5cbbb71b39ec9441da85e40838cbcc71f.png" alt="B = \mbox{Dev}(\varepsilon(u_{n+\theta}))-\varepsilon^p_{n}" style="vertical-align: -5px"/></p>
<div class="math">
<p><img src="../_images/math/5e3cd0b249d559f723d45a0cfc85908fa24a3dc6.png" alt="\varepsilon(u_{n+\theta}) = {\mathscr E}^p(u_{n+\theta}, \varepsilon^p_{n}) = \varepsilon^p_{n} + \left( 1 - \sqrt{\frac{2}{3}}\Frac{\sigma_y}{2\mu\|B\|}\right)_+ B"/></p>
</div><p><strong>Plane strain approximation</strong></p>
<p>The plane strain approximation has the same expression replacing the 3D strain tensors by the in-plane ones <img class="math" src="../_images/math/2360b453089c0a59a41421a97f81adcfd7d1b086.png" alt="\bar{\varepsilon}^p" style="vertical-align: 0px"/> and  <img class="math" src="../_images/math/f61a008a899004625ab05c2689c69b15fc83e8e7.png" alt="\bar{\varepsilon}(u_{n+\theta})" style="vertical-align: -4px"/>.</p>
<div class="math">
<p><img src="../_images/math/565191d2a7ef20ad9992e2ae4e2d030e87f4fe4e.png" alt="\bar{{\mathscr E}}^p(\bar{u}_{n+\theta}, \theta \Delta \xi, \bar{\varepsilon}^p_{n}) = \Frac{1}{1+2\mu\theta\Delta \xi}(\bar{\varepsilon}^p_{n} + 2\mu\theta\Delta \xi \mbox{Dev}^*(\bar{\varepsilon}(\bar{u}_{n+\theta}))),"/></p>
</div><p>where <img class="math" src="../_images/math/4679a6de3558770f1c9fcdc72b8c4e3a443d8e48.png" alt="\mbox{Dev}^*(\bar{\varepsilon}) = \bar{\varepsilon} - \Frac{\mbox{tr}(\bar{\varepsilon})}{3} \bar{I}" style="vertical-align: -13px"/> is still the 3D deviator.</p>
<p>Moreover, for the yield condition,</p>
<div class="math">
<p><img src="../_images/math/8dd8d124a60e684e158b5b18d8b49451c23992a9.png" alt="\mbox{Dev}(\sigma) = 2\mu\mbox{Dev}(\varepsilon(u) - \varepsilon^p) = 2\mu\left(\varepsilon(u) - \varepsilon^p - \Frac{\mbox{tr}(\bar{\varepsilon}(u)) - \mbox{tr}(\bar{\varepsilon}^p)}{3} I\right)"/></p>
</div><div class="math">
<p><img src="../_images/math/53866ddd3a7f7733a88fd0caeaab9393c4cb7545.png" alt="\begin{array}{rcl} \|\mbox{Dev}(\sigma)\| &amp;=&amp; 2\mu\sqrt{\left\|\bar{\varepsilon}(u) - \bar{\varepsilon}^p - \Frac{\mbox{tr}(\bar{\varepsilon}(u)) - \mbox{tr}(\bar{\varepsilon}^p)}{3} \bar{I}\right\|^2 + \Frac{(\mbox{tr}(\bar{\varepsilon}(u)) - \mbox{tr}(\bar{\varepsilon}^p))^2}{9}} \\ &amp;=&amp; \sqrt{\left\|\bar{\sigma} - \Frac{3\lambda+2\mu}{6(\lambda+\mu)}\mbox{tr}(\bar{\sigma})\bar{I} \right\|^2 + \Frac{\mu^2}{9(\lambda+\mu)^2}\mbox{tr}(\bar{\sigma})^2 } \end{array}"/></p>
</div><p><strong>Plane stress approximation</strong></p>
<p>For plane stress approximation, we use <a href="#equation-plane_stress_iso">(4)</a> which gives</p>
<div class="math">
<p><img src="../_images/math/4eec6e49b89eb0729b02cefa397b861478fe6c38.png" alt="\bar{\varepsilon}^p_{n+\theta} - \bar{\varepsilon}^p_{n} = \theta \Delta \xi \mbox{Dev}^*(\bar{\sigma}_{n+\theta}) =  \theta \Delta \xi \mbox{Dev}^*(\lambda^*\mbox{tr}(\bar{\varepsilon}^e_{n+\theta})\bar{I} + 2\mu \bar{\varepsilon}^e_{n+\theta}) = \theta \Delta \xi\left(\Frac{\lambda^*-2\mu}{3}\mbox{tr}(\bar{\varepsilon}^e_{n+\theta})\bar{I} + 2\mu\bar{\varepsilon}^e_{n+\theta}\right)"/></p>
</div><p>thus with <img class="math" src="../_images/math/ae2b5d3c22cd755fbd52399902314f9bcaa2835d.png" alt="\beta = \Frac{\lambda^*-2\mu}{3}" style="vertical-align: -13px"/> one has</p>
<div class="math">
<p><img src="../_images/math/76869a47a5c35c38af766e1f3c224856c0239b22.png" alt="(1+2\mu\theta \Delta \xi)\bar{\varepsilon}^p_{n+\theta} + \beta\theta \Delta \xi \mbox{tr}(\bar{\varepsilon}^p_{n+\theta})\bar{I} = \bar{\varepsilon}^p_{n} + \theta \Delta \xi\left(\beta\mbox{tr}(\bar{\varepsilon}(u_{n+\theta}))\bar{I} + 2\mu\bar{\varepsilon}(u_{n+\theta})\right)"/></p>
</div><p>By inverting this relation we find for <img class="math" src="../_images/math/ca4430af98ac0f5b49468f7a55f35254a03e7113.png" alt="A = \bar{\varepsilon}^p_{n} + \theta \Delta \xi\left(\beta\mbox{tr}(\bar{\varepsilon}(u_{n+\theta}))\bar{I} + 2\mu\bar{\varepsilon}(u_{n+\theta})\right)" style="vertical-align: -7px"/></p>
<div class="math">
<p><img src="../_images/math/34b8d371778f442094c9f26057915c337d1c7f35.png" alt="\bar{{\mathscr E}}^p(\bar{u}_{n+\theta}, \theta \Delta \xi, \bar{\varepsilon}^p_{n}) = \Frac{1}{1+2\mu\theta\Delta \xi} A - \left( \Frac{\beta\theta\Delta \xi}{(1+2\mu\theta\Delta \xi)(1+(2\mu+2\beta)\theta\Delta \xi)} \right) \mbox{tr}(A)\bar{I}"/></p>
</div></div>
<div class="section" id="isotropic-elastoplasticity-with-linear-isotropic-and-kinematic-hardening-and-von-mises-criterion">
<h3>Isotropic elastoplasticity with linear isotropic and kinematic hardening and Von-Mises criterion<a class="headerlink" href="#isotropic-elastoplasticity-with-linear-isotropic-and-kinematic-hardening-and-von-mises-criterion" title="Permalink to this headline">¶</a></h3>
<p>We consider an isotropic elastic reponse and the internal variable <img class="math" src="../_images/math/0ef53f55e9eb08b185214243cc90620a4e3e1449.png" alt="\alpha : \Omega \rightarrow \R" style="vertical-align: -1px"/> being the accumulated plastic strain which satisfies</p>
<div class="math">
<p><img src="../_images/math/231427d374fb69b459dc5310bb7b372a56b746b8.png" alt="\dot{\alpha} = \sqrt{\Frac{2}{3}}\dot{\gamma}"/></p>
</div><p>For <img class="math" src="../_images/math/f6b8031f33441a44e13d20863b7af434336499e6.png" alt="H_i" style="vertical-align: -3px"/> the isotropic hardening modulus, the linear hardening consists in</p>
<div class="math">
<p><img src="../_images/math/2618a6eab467f598326016cf1817f5bbdbaf169a.png" alt="\psi^p(\alpha) = \frac{1}{\sqrt{6}}H_i\alpha^2"/></p>
</div><p>i.e. <img class="math" src="../_images/math/ba698433765f99694708209c22567d40a1a47084.png" alt="A = \sqrt{\frac{2}{3}}H_i\alpha" style="vertical-align: -12px"/> and a uniaxial yield stress defined by</p>
<div class="math">
<p><img src="../_images/math/c9e8c1765f3d9c7462d73f0de4f422c3dbe216b4.png" alt="\sigma_y(a) = \sigma_{y0} + \sqrt{\frac{3}{2}}A = \sigma_{y0} + H_i\alpha,"/></p>
</div><p>for <img class="math" src="../_images/math/26dbb617ea44c3df47f87cc728dc2646275d612d.png" alt="\sigma_{y0}" style="vertical-align: -6px"/> the initial uniaxial yield stress. The yield function (and plastic potential since this is an associated plastic model) can be defined by</p>
<div class="math">
<p><img src="../_images/math/6280eec93005e3459d6b1bddd926f792d457cbfe.png" alt="\Psi(\sigma, A) = f(\sigma, A) = \|\mbox{Dev}(\sigma - H_k\varepsilon^p)\| - \sqrt{\frac{2}{3}}\sigma_{y0} - A,"/></p>
</div><p>where <img class="math" src="../_images/math/23ad30f8d99bc21f1ff1332aeaf71cc8d355854b.png" alt="H_k" style="vertical-align: -3px"/> is the kinematic hardening modulus. The same computation as in the previous section leads to</p>
<div class="math">
<p><img src="../_images/math/3feedfb263f05b9ed82a0e12dd6cacd1fde5b7bc.png" alt="\tilde{\mathscr E}^p(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}) = \Frac{1}{1+(2\mu+H_k)\theta\Delta \xi}(\varepsilon^p_{n} + 2\mu\theta\Delta \xi \mbox{Dev}(\varepsilon(u_{n+\theta}))),"/></p>
</div><div class="math">
<p><img src="../_images/math/4df5c041b952a0042205cbab07e25b18a4141d52.png" alt="\begin{array}{rcl} \tilde{\mathscr A}(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}, \alpha_n) &amp;=&amp; \alpha_n + \sqrt{\Frac{2}{3}}\theta \Delta \xi\|\mbox{Dev}(\sigma_{n+\theta} - H_k\varepsilon^p_{n+\theta})\| = \alpha_n + \sqrt{\Frac{2}{3}}\theta \Delta \xi\|2\mu\mbox{Dev}(\varepsilon(u_{n+\theta})) - (2\mu+H_k)\varepsilon^p_{n+\theta}\| \\ &amp;=&amp;  \alpha_n + \sqrt{\Frac{2}{3}}\Frac{\theta \Delta \xi}{1+(2\mu+H_k)\theta\Delta \xi}\|2\mu\mbox{Dev}(\varepsilon(u_{n+\theta})) - (2\mu+H_k)\varepsilon^p_{n}\| \\ &amp;=&amp; \alpha_n + \sqrt{\Frac{2}{3}}\|\varepsilon^p_{n+\theta}- \varepsilon^p_{n}\|.\end{array}"/></p>
</div><p>Note that the isotropic hardening modulus do not intervene in <img class="math" src="../_images/math/b0628d27426100d81d6d61cc5b3303ab8faef64d.png" alt="\tilde{\mathscr E}^p(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n})" style="vertical-align: -5px"/> but only in <img class="math" src="../_images/math/d21cbde12ddc9c81016c3ed877d7dcb9a8cc91db.png" alt="f(\sigma, A)" style="vertical-align: -4px"/>.</p>
<p><strong>Closest point projection approach</strong></p>
<p>Using the same approach as for the perfect isotropic plasticity, the flow rule can be written</p>
<div class="math">
<p><img src="../_images/math/9146e6eb89b5fc053c9d01a86789ddb71e193a1d.png" alt="\dot{\varepsilon}^p \in  \partial I_K(\sigma-H_k \varepsilon^p),"/></p>
</div><p>where <img class="math" src="../_images/math/7aa8585e09f872cc2754665913e9c2578fe90346.png" alt="K = \left\{ \sigma : \|\mbox{Dev}(\sigma)\| \le \sqrt{\frac{2}{3}}(\sigma_{y0}+H_i\alpha)\right\}" style="vertical-align: -13px"/>. Writting</p>
<div class="math">
<p><img src="../_images/math/442ccf1335cd06a4a043ce8ed4b32321d45d576c.png" alt="({\cal A} + H_k I)(\bar{\tau} - ({\cal A} + H_k I)^{-1}{\cal A}\varepsilon(u) + \varepsilon^p) : \dot{\varepsilon}^p \le 0 ~~ \forall \bar{\tau} \in ({\cal A} + H_k I)^{-1}K"/></p>
</div><p>we conclude applying the generalized mid-point scheme by</p>
<div class="math">
<p><img src="../_images/math/886ffa9d29f51b27eec99ae12b62e65993eae3f4.png" alt="\varepsilon^p_{n+\theta} =  \varepsilon^p_{n} + \left(I-P^{{\cal A} + H_k I}_{({\cal A} + H_k I)^{-1}K}\right)\left(({\cal A} + H_k I)^{-1}{\cal A}\varepsilon(u_{n+\theta}) - \varepsilon^p_n\right)."/></p>
</div><p>Now, since</p>
<div class="math">
<p><img src="../_images/math/aa57e12bf48632746d97620c26f6eb40f26c41c3.png" alt="\left(I-P^{{\cal A} + H_k I}_{({\cal A} + H_k I)^{-1}K}\right)(\varepsilon) =  \left(1 - \sqrt{\frac{2}{3}}\Frac{(\sigma_{y0}+H_i\alpha_{n+\theta})}{(2\mu+H_k)\|\mbox{Dev}(\varepsilon)\|}\right)_+ \mbox{Dev}(\varepsilon),"/></p>
</div><p>and <img class="math" src="../_images/math/70306eabfc335c79e5f43df58865a7b24b5de118.png" alt="\mbox{Dev}(({\cal A} + H_k I)^{-1}{\cal A}\varepsilon(u_{n+\theta})) = \Frac{2\mu}{2\mu+H_k}\mbox{Dev}(\varepsilon(u_{n+\theta}))" style="vertical-align: -17px"/> and with <img class="math" src="../_images/math/812239082bac1e612428dc030e6d722b5949f0e8.png" alt="B = 2\mu\mbox{Dev}(\varepsilon(u_{n+\theta})) - (2\mu+H_k)\varepsilon^p_n" style="vertical-align: -5px"/> one has</p>
<div class="math">
<p><img src="../_images/math/88553334ce87dcf49c1964b3335841fb543816f7.png" alt="{\mathscr E}^p(u_{n+\theta}, \varepsilon^p_{n}) = \varepsilon^p_{n+\theta} =  \varepsilon^p_{n}  + \Frac{1}{2\mu+H_k}\left(1 - \sqrt{\frac{2}{3}}\Frac{(\sigma_{y0}+H_i\alpha_{n+\theta})}{\|B\|}\right)_+ B."/></p>
</div><p>The problem is not completely solved since <img class="math" src="../_images/math/7bc6d32ff1ee0a50b54685b636fe4f89e1388e9c.png" alt="\alpha_{n+\theta}" style="vertical-align: -4px"/> is still undetermined. However</p>
<div class="math">
<p><img src="../_images/math/8fff827ffb9c0446e15facc63a45e7d7b533aeb1.png" alt="\alpha_{n+\theta} = \alpha_{n} + \sqrt{\Frac{2}{3}}\|\varepsilon^p_{n+\theta} - \varepsilon^p_{n}\| = \alpha_{n} + \sqrt{\Frac{2}{3}}\Frac{1}{2\mu+H_k}\left(\|B\| - \sqrt{\frac{2}{3}}(\sigma_{y0}+H_i\alpha_{n+\theta})\right)_+."/></p>
</div><p>Thus</p>
<div class="math">
<p><img src="../_images/math/455f99fa1e872958fe77e0215dfa0ab5849e77a8.png" alt="{\mathscr A}(u_{n+\theta}, \varepsilon^p_{n}) = \alpha_{n+\theta} = \max\left(\alpha_{n}, \Frac{\sqrt{\Frac{3}{2}}(2\mu+H_k)\alpha_n+\|B\| - \sqrt{\frac{2}{3}}\sigma_{y0}}{\sqrt{\Frac{3}{2}}(2\mu+H_k)+\sqrt{\frac{2}{3}}H_i}\right),"/></p>
</div><p>which complete the expression.</p>
<p><strong>Plane strain approximation</strong></p>
<p>The plane strain approximation has the same expression replacing the 3D strain tensors by the in-plane ones <img class="math" src="../_images/math/2360b453089c0a59a41421a97f81adcfd7d1b086.png" alt="\bar{\varepsilon}^p" style="vertical-align: 0px"/> and  <img class="math" src="../_images/math/f61a008a899004625ab05c2689c69b15fc83e8e7.png" alt="\bar{\varepsilon}(u_{n+\theta})" style="vertical-align: -4px"/>.</p>
</div>
<div class="section" id="souza-auricchio-elastoplasticity-law-for-shape-memory-alloys">
<h3>Souza-Auricchio elastoplasticity law (for shape memory alloys)<a class="headerlink" href="#souza-auricchio-elastoplasticity-law-for-shape-memory-alloys" title="Permalink to this headline">¶</a></h3>
<p>See for instance <a class="reference internal" href="../biblio.html#gr-st2015" id="id9">[GR-ST2015]</a> for the justification of the construction of this flow rule. A Von-Mises stress criterion together with an isotropic elastic response, no internal variables and a special type of kinematic hardening is considered with a constraint <img class="math" src="../_images/math/1afce3d5fdd2c03566b026b345a266aaa978c4d7.png" alt="\|\varepsilon^p\| \le c_3" style="vertical-align: -5px"/>. The plastic potential and yield function have the form</p>
<div class="math">
<p><img src="../_images/math/acf084b2828494dec9ae8d9119f4652e2162ea18.png" alt="\Psi(\sigma) = f(\sigma)  = \left\|\mbox{Dev}\left(\sigma - c_1\Frac{\varepsilon^p}{\|\varepsilon^p\|} - c_2\varepsilon^p - \delta \Frac{\varepsilon^p}{\|\varepsilon^p\|}\right)\right\| - \sqrt{\frac{2}{3}}\sigma_{y},"/></p>
</div><p>with the complementarity condition</p>
<div class="math">
<p><img src="../_images/math/56a077b7f2d8c8622a4849b865f90552fac56e22.png" alt="\delta \ge 0, \|\varepsilon^p\| \le c_3,  \delta (\|\varepsilon^p\|-c_3) = 0,"/></p>
</div><p>where <img class="math" src="../_images/math/275bb0b189ef7ae79f437cdda86296463870a450.png" alt="c_1, c_2 \mbox{ and } c_3" style="vertical-align: -4px"/> are some physical parameters. Note that <img class="math" src="../_images/math/f4776bafc98d5d7605a0eb5723841ae3a3ce289d.png" alt="\Frac{\varepsilon^p}{\|\varepsilon^p\|}" style="vertical-align: -18px"/> has to be understood to be the whole unit ball for <img class="math" src="../_images/math/cf0db9c3802197f5f690db5f1aaaf196dbf0f2d2.png" alt="\varepsilon^p = 0" style="vertical-align: 0px"/>.</p>
<p>The integration of the flow rule reads</p>
<div class="math" id="equation-souza_auri_comp">
<p><span class="eqno">(5)</span><img src="../_images/math/684e1698a38f931a17ac8f3bb223f611a82e94bd.png" alt="\varepsilon^p_{n+\theta} - \varepsilon^p_{n} = \theta \Delta \xi \mbox{Dev}\left(\sigma_{n+\theta} - (c_1 + \delta)\Frac{\varepsilon^p_{n+\theta}}{\|\varepsilon^p_{n+\theta}\|} - c_2\varepsilon^p_{n+\theta}\right)."/></p>
</div><p>which can be transformed in</p>
<div class="math">
<p><img src="../_images/math/8d544ec75f83e966a443a9d604c182fb8129e71d.png" alt="(1+(2\mu+c_2)\theta\Delta \xi)\varepsilon^p_{n+\theta} + \theta\Delta \xi(c_1+\delta)\Frac{\varepsilon^p_{n+\theta}}{\|\varepsilon^p_{n+\theta}\|} = \varepsilon^p_{n} + \theta\Delta \xi 2\mu \mbox{Dev}(\varepsilon(u_{n+\theta}))."/></p>
</div><p>With</p>
<div class="math">
<p><img src="../_images/math/d53729612b338dc4eb107340efbd619df802e1c2.png" alt="B = \varepsilon^p_{n} + \theta\Delta \xi 2\mu \mbox{Dev}(\varepsilon(u_{n+\theta})),"/></p>
</div><p>we conclude that <img class="math" src="../_images/math/085d04265488dc0f2c64582c0161bcfb2723a520.png" alt="\Frac{\varepsilon^p_{n+\theta}}{\|\varepsilon^p_{n+\theta}\|} = \Frac{B}{\|B\|}" style="vertical-align: -19px"/> and then <img class="math" src="../_images/math/853f194fd102dd99806e24d2fee8b5c2c3f0453f.png" alt="\varepsilon^p_{n+\theta} = 0" style="vertical-align: -6px"/> for <img class="math" src="../_images/math/8fd5a8e5d1c94d49ff7883f61bc6f349ac02a8ca.png" alt="\|B\| \le \theta\Delta \xi c_1" style="vertical-align: -5px"/> and</p>
<div class="math">
<p><img src="../_images/math/e5be402ae8603e2ab01116ab30b4c5c51b0011be.png" alt="(1+(2\mu+c_2)\theta\Delta \xi)\varepsilon^p_{n+\theta} = \Frac{B}{\|B\|} (\|B\| - \theta\Delta \xi(c_1+\delta))."/></p>
</div><p>Since <img class="math" src="../_images/math/febbc6e8783db32e24790e16a4389a30615eb1fc.png" alt="\|\varepsilon^p_{n+\theta}\| = c_3" style="vertical-align: -6px"/> for <img class="math" src="../_images/math/9a4b1ee77622f50ac112610b5be1c8feb031ef31.png" alt="\delta &gt; 0" style="vertical-align: 0px"/> (complementarity condition), we can deduce the following expression for <img class="math" src="../_images/math/755cf25b94df15c4dc3be4c6aef2179deaca5e7f.png" alt="\varepsilon^p_{n+\theta}" style="vertical-align: -6px"/>:</p>
<div class="math">
<p><img src="../_images/math/04375033d00c364b43f505239d97d239f86e9f8b.png" alt="\tilde{\mathscr E}^p(u_{n+\theta}, \theta \Delta \xi, \varepsilon^p_{n}) = B \min\left(\Frac{c_3}{\|B\|}, \Frac{\left(1 - \Frac{\theta\Delta \xi c_1}{\|B\|}\right)_+}{1+(2\mu+c_2)\theta\Delta \xi}\right)."/></p>
</div><p>The yield condition reads then</p>
<div class="math">
<p><img src="../_images/math/77299a8f73165be4b76155f7b8f3026e426ee0eb.png" alt="\begin{array}{l} f(\sigma_{n+\theta}) = \left\|2\mu\mbox{Dev}(\varepsilon(u_{n+\theta})) - (2\mu+c_2)\varepsilon^p_{n+\theta} - \max\left(c_1, \Frac{\|B\|-c3}{\theta\Delta \xi} - (2\mu+c2)c_3\right)\varepsilon^p_{n+\theta} \right\| \\ ~~~ - \sqrt{\frac{2}{3}}\sigma_{y} \le 0,\end{array}"/></p>
</div><p><strong>Plane strain approximation</strong></p>
<p>The plane strain approximation has the same expression replacing the 3D strain tensors by the in-plane ones <img class="math" src="../_images/math/2360b453089c0a59a41421a97f81adcfd7d1b086.png" alt="\bar{\varepsilon}^p" style="vertical-align: 0px"/> and  <img class="math" src="../_images/math/f61a008a899004625ab05c2689c69b15fc83e8e7.png" alt="\bar{\varepsilon}(u_{n+\theta})" style="vertical-align: -4px"/>.</p>
</div>
</div>
<div class="section" id="some-classical-modelizations">
<h2>Some classical modelizations<a class="headerlink" href="#some-classical-modelizations" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="elasto-plasticity-bricks">
<h2>Elasto-plasticity bricks<a class="headerlink" href="#elasto-plasticity-bricks" title="Permalink to this headline">¶</a></h2>
<div class="section" id="generic-brick">
<h3>Generic brick<a class="headerlink" href="#generic-brick" title="Permalink to this headline">¶</a></h3>
<p>The generic brick add the following terms:</p>
<div class="math">
<p><img src="../_images/math/0618de137b8c9943a052e12fd6d49ca54ab47d53.png" alt="\int_{\Omega} \sigma_{n+1} : \nabla v dx +  \ds \int_{\Omega} (\Delta \xi - (\Delta \xi + r f(\sigma_{n+\theta}, A_{n+\theta}))_+) \lambda dx = 0,   \forall \lambda"/></p>
</div></div>
<div class="section" id="other-bricks">
<h3>Other bricks<a class="headerlink" href="#other-bricks" title="Permalink to this headline">¶</a></h3>
<p>to be done:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">add_elastoplasticity_brick</span>
    <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">ACP</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">datalambda</span><span class="p">,</span> <span class="n">datamu</span><span class="p">,</span> <span class="n">datathreshold</span><span class="p">,</span> <span class="n">datasigma</span><span class="p">,</span> <span class="n">region</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="section" id="a-specific-brick-based-on-the-low-level-generic-assembly-for-perfect-plasticity">
<h3>A specific brick based on the low-level generic assembly for perfect plasticity<a class="headerlink" href="#a-specific-brick-based-on-the-low-level-generic-assembly-for-perfect-plasticity" title="Permalink to this headline">¶</a></h3>
<p>This is an previous version of a elastoplasticity brick which is restricted to  isotropic perfect plasticity and is based on the low-level generic assembly. Its specificity which could be interesting for testing is that the flow rule is integrated on  finite element nodes (not on Gauss points).</p>
<p>The function adding this brick to a model is:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">add_elastoplasticity_brick</span>
    <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">ACP</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">previous_varname</span><span class="p">,</span> <span class="n">datalambda</span><span class="p">,</span> <span class="n">datamu</span><span class="p">,</span> <span class="n">datathreshold</span><span class="p">,</span> <span class="n">datasigma</span><span class="p">,</span> <span class="n">region</span><span class="p">);</span>
</pre></div>
</div>
<dl class="docutils">
<dt>where:</dt>
<dd><ul class="first last simple">
<li><tt class="docutils literal"><span class="pre">varname</span></tt> represents the main displacement unknown on which the brick is added (u).</li>
<li><tt class="docutils literal"><span class="pre">previous_varname</span></tt> is the displacement at the previous time step.</li>
<li><tt class="docutils literal"><span class="pre">datalambda</span></tt> and <tt class="docutils literal"><span class="pre">datamu</span></tt> are the data corresponding to the Lame coefficients.</li>
<li><tt class="docutils literal"><span class="pre">datathreshold</span></tt> represents the plastic threshold of the studied material.</li>
<li><tt class="docutils literal"><span class="pre">datasigma</span></tt> represents the stress constraint values supported by the material. It should be composed of 2 iterates for the time scheme needed for the Newton algorithm used. Note that the finite element method on which <tt class="docutils literal"><span class="pre">datasigma</span></tt> is defined should be able to represent the derivative of <tt class="docutils literal"><span class="pre">varname</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">ACP</span></tt> corresponds to the type of projection to be used. It has an <cite>abstract_constraints_projection</cite> type and for the moment, only exists the <cite>VM_projection</cite> corresponding to the Von Mises one.</li>
</ul>
</dd>
</dl>
<p>Be careful: <tt class="docutils literal"><span class="pre">datalambda</span></tt>, <tt class="docutils literal"><span class="pre">datamu</span></tt> and <tt class="docutils literal"><span class="pre">datathreshold</span></tt> could be constants or described on the same finite element method.</p>
<p>This function assembles the tangent matrix and the right hand side vector which will be solved using a Newton algorithm.</p>
<div class="section" id="other-useful-functions">
<h4>Other useful functions<a class="headerlink" href="#other-useful-functions" title="Permalink to this headline">¶</a></h4>
<p>The function:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">elastoplasticity_next_iter</span>
    <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">previous_varname</span><span class="p">,</span> <span class="n">ACP</span><span class="p">,</span> <span class="n">datalambda</span><span class="p">,</span> <span class="n">datamu</span><span class="p">,</span> <span class="n">datathreshold</span><span class="p">,</span> <span class="n">datasigma</span><span class="p">);</span>
</pre></div>
</div>
<p>computes the new stress constraint values supported by the material after a load or an unload (once a solve has been done earlier) and upload the variables <tt class="docutils literal"><span class="pre">varname</span></tt> and <tt class="docutils literal"><span class="pre">datasigma</span></tt> as follows:</p>
<div class="math">
<p><img src="../_images/math/a580e8c759b8e8e17d25850746b9aac4452e0d09.png" alt="u^{n+1} \Rightarrow u^n \ \ \ \ \ \textrm{ and } \ \ \ \ \ \sigma^{n+1} \Rightarrow \sigma^n"/></p>
</div><p>Then, <img class="math" src="../_images/math/292a206403c44be137a56e14cfc01788c0ee895a.png" alt="u^n" style="vertical-align: 0px"/> and <img class="math" src="../_images/math/298bfa17b21080be1d1e607e3d982a0dcfa0ea30.png" alt="\sigma^n" style="vertical-align: 0px"/> contains the new values computed and one can restart the process.</p>
<hr class="docutils" />
<p>The function:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">compute_elastoplasticity_Von_Mises_or_Tresca</span>
    <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">datasigma</span><span class="p">,</span> <span class="n">mf_vm</span><span class="p">,</span> <span class="n">VM</span><span class="p">,</span> <span class="n">tresca</span><span class="o">=</span><span class="nb">false</span><span class="p">);</span>
</pre></div>
</div>
<p>computes the Von Mises (or Tresca if <tt class="docutils literal"><span class="pre">tresca</span></tt> = true) criterion on the stress tensor stored in <tt class="docutils literal"><span class="pre">datasigma</span></tt> . The stress is evaluated on the <cite>mesh_fem</cite> <tt class="docutils literal"><span class="pre">mf_vm</span></tt> and stored into the vector <tt class="docutils literal"><span class="pre">VM</span></tt>.
Of course, this function can be used if and only if the previous function <tt class="docutils literal"><span class="pre">elastoplasticity_next_iter</span></tt> has been called earlier.</p>
<hr class="docutils" />
<p>The function:</p>
<div class="highlight-c++"><div class="highlight"><pre><span class="n">getfem</span><span class="o">::</span><span class="n">compute_plastic_part</span>
    <span class="p">(</span><span class="n">md</span><span class="p">,</span> <span class="n">mim</span><span class="p">,</span> <span class="n">mf_pl</span><span class="p">,</span> <span class="n">varname</span><span class="p">,</span> <span class="n">previous_varname</span><span class="p">,</span> <span class="n">ACP</span><span class="p">,</span> <span class="n">datalambda</span><span class="p">,</span> <span class="n">datamu</span><span class="p">,</span> <span class="n">datathreshold</span><span class="p">,</span> <span class="n">datasigma</span><span class="p">,</span> <span class="n">Plast</span><span class="p">);</span>
</pre></div>
</div>
<p>computes on <tt class="docutils literal"><span class="pre">mf_pl</span></tt> the plastic part of the material, that could appear after a load and an unload, into the vector <tt class="docutils literal"><span class="pre">Plast</span></tt>.</p>
<p>Note that <tt class="docutils literal"><span class="pre">datasigma</span></tt> should be the vector containing the new stress constraint values, i.e. after a load or an unload of the material.</p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
  <p class="logo"><a href="../index.html">
    <img class="logo" src="../_static/logo_getfem_small.png" alt="Logo"/>
  </a></p>
  <h3><a href="../contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Small strain plasticity</a><ul>
<li><a class="reference internal" href="#theoretical-background">Theoretical background</a><ul>
<li><a class="reference internal" href="#additive-decomposition-of-the-small-strain-tensor">Additive decomposition of the small strain tensor</a></li>
<li><a class="reference internal" href="#internal-variables-free-energy-potential-and-elastic-law">Internal variables, free energy potential and elastic law</a></li>
<li><a class="reference internal" href="#plastic-potential-yield-function-and-plastic-flow-rule">Plastic potential, yield function and plastic flow rule</a></li>
<li><a class="reference internal" href="#initial-boundary-value-problem">Initial boundary value problem</a></li>
</ul>
</li>
<li><a class="reference internal" href="#flow-rule-integration">Flow rule integration</a><ul>
<li><a class="reference internal" href="#plane-strain-approximation">Plane strain approximation</a></li>
<li><a class="reference internal" href="#plane-stress-approximation">Plane stress approximation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#some-classical-laws">Some classical laws</a><ul>
<li><a class="reference internal" href="#perfect-isotropic-associated-elastoplasticity-with-von-mises-criterion-prandl-reuss-model">Perfect isotropic associated elastoplasticity with Von-Mises criterion (Prandl-Reuss model)</a></li>
<li><a class="reference internal" href="#isotropic-elastoplasticity-with-linear-isotropic-and-kinematic-hardening-and-von-mises-criterion">Isotropic elastoplasticity with linear isotropic and kinematic hardening and Von-Mises criterion</a></li>
<li><a class="reference internal" href="#souza-auricchio-elastoplasticity-law-for-shape-memory-alloys">Souza-Auricchio elastoplasticity law (for shape memory alloys)</a></li>
</ul>
</li>
<li><a class="reference internal" href="#some-classical-modelizations">Some classical modelizations</a></li>
<li><a class="reference internal" href="#elasto-plasticity-bricks">Elasto-plasticity bricks</a><ul>
<li><a class="reference internal" href="#generic-brick">Generic brick</a></li>
<li><a class="reference internal" href="#other-bricks">Other bricks</a></li>
<li><a class="reference internal" href="#a-specific-brick-based-on-the-low-level-generic-assembly-for-perfect-plasticity">A specific brick based on the low-level generic assembly for perfect plasticity</a><ul>
<li><a class="reference internal" href="#other-useful-functions">Other useful functions</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="model_nonlinear_elasticity.html"
                        title="previous chapter">Finite strain Elasticity bricks</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="model_ALE_rotating.html"
                        title="next chapter">ALE Support for object having a large rigid body motion</a></p>            <h3>Download</h3>
            <p><a href="../download.html">Download GetFEM++ </a></p>
	    <h3>Main documentations</h3>
	    <ul>
              
	      <li><a href="index.html">GetFEM++ User documentation</a></li>
              <li><a href="../python/index.html">Python Interface</a></li>
	      <li><a href="../matlab/index.html">Matlab Interface</a></li>
	      <li><a href="../scilab/index.html">Scilab Interface</a></li>
	      <li><a href="../gmm/index.html"> Gmm++</a></li>
	      <li><a href="../project/index.html"> GetFEM++ project</a></li>
            </ul>

            <h3>Other resources</h3>
            <ul>
              <li><a href="../screenshots/shots.html">Screenshots</a></li>
              <li><a href="../links.html">Related links</a></li>
	      <li><a href="http://home.gna.org/getfem/getfem_faq.html">FAQs</a></li>
              <li><a href="https://gna.org">Hosted by GNA! </a></li>
              
              
            </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="model_ALE_rotating.html" title="ALE Support for object having a large rigid body motion"
             >next</a> |</li>
        <li class="right" >
          <a href="model_nonlinear_elasticity.html" title="Finite strain Elasticity bricks"
             >previous</a> |</li>
        <li><a href="http://gna.org/projects/getfem" <img src="../_static/icon.png" alt=""
                 style="vertical-align: middle; margin-top: -1px"/></li></a>
        <li><a href="../index.html">GetFEM++</a> &raquo;</li>

          <li><a href="index.html" >User Documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; <a href="../copyright.html">Copyright</a> 2004-2015 GetFEM++ project.
    </div>
  </body>
</html>